<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Springæ³¨è§£é©±åŠ¨å¼€å‘ | å°è®©ã®ç³–æœå±‹</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/favicon.ico">
    <script charset="utf-8" async="async" src="/blog/js/jquery.min.js"></script>
    <script charset="utf-8" async="async" src="/blog/js/global.js"></script>
    <script charset="utf-8" async="async" src="/blog/js/fingerprint2.min.js"></script>
    <script>
              var _hmt = _hmt || [];
              (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?0b31b4c146bf7126aed5009e1a4a11c8";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
              })();
            </script>
    <meta name="description" content="åŒ…å«: Java åŸºç¡€, Javaè®¾è®¡æ¨¡å¼, æ•°æ®ç»“æ„ä¸ç®—æ³•, æºç åˆ†æ...">
    <meta property="article:modified_time" content="2022-11-12T23:53:01.000Z">
    <meta property="og:title" content="Springæ³¨è§£é©±åŠ¨å¼€å‘">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html">
    <meta name="twitter:title" content="Springæ³¨è§£é©±åŠ¨å¼€å‘">
    <meta name="twitter:url" content="/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="spring, æ³¨è§£">
    <meta property="article:tag" content="spring">
    <meta name="robots" content="all">
    <meta name="author" content="å°è®©">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="keywords" content="å°è®©ã®ç³–æœå±‹, æ•°æ®ç»“æ„ä¸ç®—æ³•, è®¾è®¡æ¨¡å¼, æºç åˆ†æ, JavaåŸºç¡€, å…«è‚¡æ–‡">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/blog/assets/css/0.styles.81cff77c.css" as="style"><link rel="preload" href="/blog/assets/css/styles.css?v=1668302853734" as="style"><link rel="preload" href="/blog/assets/js/cg-styles.js?v=1668302853734" as="script"><link rel="preload" href="/blog/assets/js/cg-app.js?v=1668302853734" as="script"><link rel="preload" href="/blog/assets/js/cg-3.js?v=1668302853734" as="script"><link rel="preload" href="/blog/assets/js/cg-4.js?v=1668302853734" as="script"><link rel="preload" href="/blog/assets/js/cg-21.js?v=1668302853734" as="script">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.81cff77c.css"><link rel="stylesheet" href="/blog/assets/css/styles.css?v=1668302853734">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">å°è®©ã®ç³–æœå±‹</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/md/other/guide-to-reading.html" class="nav-link">
  å¯¼è¯»
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç®—æ³•" class="dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/md/æ•°æ®ç»“æ„ä¸ç®—æ³•/æ•°æ®ç»“æ„/" class="nav-link">
  æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/blog/md/æ•°æ®ç»“æ„ä¸ç®—æ³•/ç®—æ³•/æ’åºç®—æ³•/å†’æ³¡æ’åº.html" class="nav-link">
  ç®—æ³•ä¸»é¢˜
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/md/java/interview/HashMap.html" class="nav-link">
  é¢è¯•å®å…¸
</a></li><li class="dropdown-item"><!----> <a href="/blog/md/java/core/" class="nav-link">
  åŸºç¡€æŠ€æœ¯
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Springå…¨å®¶æ¡¶" class="dropdown-title"><span class="title">Springå…¨å®¶æ¡¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/IOC/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/blog/md/springå…¨å®¶æ¡¶/springmvc/åŸºç¡€/" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-item"><!----> <a href="/blog/md/springå…¨å®¶æ¡¶/spring-security/åŸºç¡€/" class="nav-link">
  SpringSecurity
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/md/other/guide-to-reading.html" class="nav-link">
  å¯¼è¯»
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç®—æ³•" class="dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/md/æ•°æ®ç»“æ„ä¸ç®—æ³•/æ•°æ®ç»“æ„/" class="nav-link">
  æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/blog/md/æ•°æ®ç»“æ„ä¸ç®—æ³•/ç®—æ³•/æ’åºç®—æ³•/å†’æ³¡æ’åº.html" class="nav-link">
  ç®—æ³•ä¸»é¢˜
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/md/java/interview/HashMap.html" class="nav-link">
  é¢è¯•å®å…¸
</a></li><li class="dropdown-item"><!----> <a href="/blog/md/java/core/" class="nav-link">
  åŸºç¡€æŠ€æœ¯
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Springå…¨å®¶æ¡¶" class="dropdown-title"><span class="title">Springå…¨å®¶æ¡¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/IOC/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/blog/md/springå…¨å®¶æ¡¶/springmvc/åŸºç¡€/" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-item"><!----> <a href="/blog/md/springå…¨å®¶æ¡¶/spring-security/åŸºç¡€/" class="nav-link">
  SpringSecurity
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>SpringåŸºç¡€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/IOC.html" class="sidebar-link">Spring-IOC</a></li><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/AOP.html" class="sidebar-link">Spring-AOP</a></li><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/JDBC.html" class="sidebar-link">Spring-JDBC</a></li><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/äº‹åŠ¡.html" class="sidebar-link">Springäº‹åŠ¡</a></li><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/Springæ³¨è§£é©±åŠ¨å¼€å‘.html" class="active sidebar-link">Springæ³¨è§£é©±åŠ¨å¼€å‘</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Springæºç åˆ†æ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/æºç /Springæºç ç¯å¢ƒæ­å»º.html" class="sidebar-link">Springæºç ç¯å¢ƒæ­å»º</a></li><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/æºç /Springæ³¨å†ŒBeançš„å‡ ç§æ–¹å¼.html" class="sidebar-link">Springæ³¨å†ŒBeançš„å‡ ç§æ–¹å¼</a></li><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/æºç /Spring-BeanDefinitionåŠ è½½æµç¨‹åˆ†æ.html" class="sidebar-link">Spring-BeanDefinitionåŠ è½½æµç¨‹åˆ†æ</a></li><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/æºç /Spring-ConfigurationClassPostProcessoråç½®å¤„ç†å™¨è¯¦è§£.html" class="sidebar-link">Spring-ConfigurationClassPostProcessoråç½®å¤„ç†å™¨è¯¦è§£</a></li><li><a href="/blog/md/springå…¨å®¶æ¡¶/spring/æºç /Springäº‹ä»¶è®¢é˜…ä¸å‘å¸ƒåŸç†åˆ†æ.html" class="sidebar-link">Springäº‹ä»¶è®¢é˜…ä¸å‘å¸ƒåŸç†åˆ†æ</a></li></ul></section></li></ul> </aside> <div><main class="page"> <div class="theme-default-content content__default"><h1 id="spring-æ³¨è§£é©±åŠ¨å¼€å‘"><a href="#spring-æ³¨è§£é©±åŠ¨å¼€å‘" class="header-anchor">#</a> Spring æ³¨è§£é©±åŠ¨å¼€å‘</h1> <h2 id="_1-æ¥”å­"><a href="#_1-æ¥”å­" class="header-anchor">#</a> 1. æ¥”å­</h2> <blockquote><p>æœ¬ç« èŠ‚æ‰€æ¶‰åŠåˆ°çš„ä»£ç åœ¨ <a href="https://github.com/xihuanxiaorang/spring-study" target="_blank" rel="noopener noreferrer">GitHub - xihuanxiaorang/spring-study: ç”¨äºspringå­¦ä¹ <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä»“åº“ä¸­çš„ <code>annotation</code> æ¨¡å—ï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ã€‚</p></blockquote> <p>é¢å‘ Spring å¼€å‘å·²ç»é€æ¸ä»ç¹ççš„ XML é…ç½®æ–‡ä»¶å‘å±•åˆ°ç®€å•å¥½ç”¨çš„æ³¨è§£é©±åŠ¨æ¨¡å¼ï¼Œå°¤å…¶æ˜¯åœ¨ Springboot è¿™æ ·ä¸€æ¬¾å¿«é€Ÿå¼€å‘è„šæ‰‹æ¶ä¸­ï¼Œåº•å±‚å¤§é‡ä½¿ç”¨æ³¨è§£å®Œæˆå„ç§å„æ ·çš„é«˜çº§åŠŸèƒ½ï¼Œæ‰€ä»¥è¯´éå¸¸æœ‰å¿…è¦æ•´ç†ä¸‹ Spring æä¾›çš„å¸¸ç”¨æ³¨è§£ã€‚ä¾¿äºè®°å¿†ï¼Œå°†å…¶åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼š<strong>ç»„ä»¶æ³¨å†Œ</strong>ã€<strong>ç”Ÿå‘½å‘¨æœŸ</strong>ã€<strong>å±æ€§èµ‹å€¼</strong> å’Œ <strong>è‡ªåŠ¨è£…é…</strong>ã€‚</p> <h2 id="_2-ç»„ä»¶æ³¨å†Œ"><a href="#_2-ç»„ä»¶æ³¨å†Œ" class="header-anchor">#</a> 2. ç»„ä»¶æ³¨å†Œ</h2> <h3 id="_2-1-configuration-bean-æ³¨è§£"><a href="#_2-1-configuration-bean-æ³¨è§£" class="header-anchor">#</a> 2.1. @Configuration&amp;@Bean æ³¨è§£</h3> <p>å…ˆæ¥å›é¡¾ä¸€ä¸‹ä½¿ç”¨ XML é…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥åˆ›å»ºå’Œç®¡ç† bean å¯¹è±¡ã€‚å…ˆæ¥åˆ›å»ºä¸€ä¸ªç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>  
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> age<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;Person{&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;name='&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span> <span class="token string">&quot;, age='&quot;</span> <span class="token operator">+</span> age <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span> <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>ç„¶åå†åˆ›å»ºä¸€ä¸ª Spring çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ <code>applicationContext.xml</code>ï¼š</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans  
       http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>person<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation.bean.Person<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xiaorang<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>åˆ›å»ºæµ‹è¯•ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringXmlConfigurationTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringXmlConfigurationTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:applicationContext.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> beanDefinitionNames <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBeanDefinitionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> beanDefinitionName <span class="token operator">:</span> beanDefinitionNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>beanDefinitionName<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤º:<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126932.png" loading="lazy" class="lazy"></p> <p>åœ¨ä¸Šé¢å·²ç»ç®€å•æ¼”ç¤ºå¦‚ä½•é€šè¿‡ XML é…ç½®æ–‡ä»¶çš„æ–¹å¼å°† JavaBean å¯¹è±¡æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚é‚£ä¹ˆä½¿ç”¨æ³¨è§£çš„æ–¹å¼åˆè¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¯”ä½¿ç”¨ XML é…ç½®æ–‡ä»¶çš„æ–¹å¼è¦ç®€å•çš„å¤šï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼Œå¹¶ <strong>åœ¨è¯¥ç±»ä¸Šæ·»åŠ  <code>@Configuration</code> æ³¨è§£ç”¨æ¥æ ‡è¯†è¯¥ç±»æ˜¯ Spring ä¸­çš„ä¸€ä¸ªé…ç½®ç±»</strong>ï¼Œæœ€å <strong>é€šè¿‡åœ¨è¯¥ç±»ä¸­çš„æŸä¸ªæ–¹æ³•ä¸Šæ·»åŠ  <code>@Bean</code> æ³¨è§£æ ‡è¯†å°†è¯¥æ–¹æ³•çš„è¿”å›å€¼å¯¹è±¡æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­</strong>ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> beanDefinitionNames <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBeanDefinitionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> beanDefinitionName <span class="token operator">:</span> beanDefinitionNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>beanDefinitionName<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126575.png" loading="lazy" class="lazy"></p> <p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨æ³¨è§£é©±åŠ¨æ–¹å¼å¼€å‘ä¹‹åï¼Œå°±ä¸å†éœ€è¦ XML é…ç½®æ–‡ä»¶ã€‚åªéœ€å°†é…ç½®æ–‡ä»¶ =&gt; é…ç½®ç±» (<code>@Configuration</code>)ï¼Œ<code>&lt;bean id=&quot;&quot; class=&quot;&quot; /&gt;</code> æ ‡ç­¾ =&gt; <code>@Bean</code> æ³¨è§£ï¼Œå®¹å™¨å¯¹è±¡ä» <code>ClassPathXmlApplicationContext</code> =&gt; <code>AnnotationConfigApplicationContext</code> ã€‚<br> <strong>ç»“è®º</strong>ï¼š<code>@Configuration</code> æ³¨è§£æ­é… <code>@Bean</code> æ³¨è§£å¯ä»¥ä»£æ›¿ XML é…ç½®æ–‡ä»¶å®Œæˆå¯¹è±¡çš„åˆ›å»ºå’Œç®¡ç†ã€‚</p> <h4 id="_2-1-1-ç»†èŠ‚åˆ†æ-1-configuration-æ³¨è§£"><a href="#_2-1-1-ç»†èŠ‚åˆ†æ-1-configuration-æ³¨è§£" class="header-anchor">#</a> 2.1.1. ç»†èŠ‚åˆ†æ 1ï¼š@Configuration æ³¨è§£</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Documented</span>  
<span class="token annotation punctuation">@Component</span>  
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Configuration</span> <span class="token punctuation">{</span>  
   <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
   <span class="token keyword">boolean</span> <span class="token function">proxyBeanMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è¡¨æ˜å½“å‰ç±»æ˜¯ Spring ä¸­çš„ä¸€ä¸ªé…ç½®ç±»ï¼Œä½œç”¨æ˜¯ <strong>ä»£æ›¿ Spring ä¸­çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ <code>applicationContext.xml</code></strong> ã€‚ä½†å…¶ <strong>æœ¬è´¨å°±æ˜¯ <code>@Component</code> æ³¨è§£</strong>ï¼Œæ‰€ä»¥è¯´è¢«æ­¤æ³¨è§£ä¿®é¥°çš„ç±»ï¼ŒåŒæ ·ä¼šè¢«æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚</p> <h4 id="_2-1-2-ç»†èŠ‚åˆ†æ-2-bean-æ³¨è§£"><a href="#_2-1-2-ç»†èŠ‚åˆ†æ-2-bean-æ³¨è§£" class="header-anchor">#</a> 2.1.2. ç»†èŠ‚åˆ†æ 2ï¼š@Bean æ³¨è§£</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION_TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Documented</span>  
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Bean</span> <span class="token punctuation">{</span>
	<span class="token comment">// ç”¨äºæŒ‡å®šæ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ bean çš„æ ‡è¯† (id)ã€‚æ”¯æŒæŒ‡å®šå¤šä¸ªæ ‡è¯†ï¼Œå½“ä¸æŒ‡å®šè¯¥å±æ€§æ—¶ï¼Œé»˜è®¤å€¼ä¸ºå½“å‰æ–¹æ³•åã€‚</span>
	<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>  
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>  
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	
	<span class="token comment">// ç”¨äºæŒ‡å®šæ˜¯å¦æ”¯æŒè‡ªåŠ¨æŒ‰ç±»å‹æ³¨å…¥åˆ°å…¶ä»– bean ä¸­ã€‚åªå½±å“ `@Autowired` æ³¨è§£ä½¿ç”¨ï¼Œä¸ä¼šå½±å“ `@Resource` æ³¨è§£ã€‚é»˜è®¤å€¼ä¸º trueã€‚</span>
	<span class="token keyword">boolean</span> <span class="token function">autowireCandidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// </span>

	<span class="token comment">// ç”¨äºæŒ‡å®š bean ä¸­å“ªä¸ªæ–¹æ³•ä½œä¸ºåˆå§‹åŒ–æ–¹æ³•</span>
	<span class="token class-name">String</span> <span class="token function">initMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token comment">// ç”¨äºæŒ‡å®š bean ä¸­å“ªä¸ªæ–¹æ³•ä½œä¸ºé”€æ¯æ–¹æ³•</span>
	<span class="token class-name">String</span> <span class="token function">destroyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">AbstractBeanDefinition</span><span class="token punctuation">.</span><span class="token constant">INFER_METHOD</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong><code>@Bean</code> æ³¨è§£æ·»åŠ åœ¨æ–¹æ³•ä¸Š</strong>ï¼Œ<strong>ç”¨äºç»™ Spring å®¹å™¨ä¸­æ³¨å†Œ bean å®ä¾‹</strong>ã€‚å…¶ä¸­ï¼Œ<strong>bean çš„ç±»å‹ä¸ºæ–¹æ³•çš„è¿”å›å€¼ç±»å‹</strong>ï¼Œ<strong>bean çš„ id é»˜è®¤ä¸ºæ–¹æ³•å</strong>ï¼Œå¯ä»¥é€šè¿‡æ³¨è§£ä¸­çš„ name æˆ–è€… value å±æ€§ä¿®æ”¹ bean çš„ idã€‚<br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<strong>è¢« <code>@Bean</code> æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ä¸­çš„å‚æ•°éƒ½æ˜¯ä» Spring å®¹å™¨ä¸­è·å–çš„</strong>ï¼</p> <h3 id="_2-2-componentscan-æ³¨è§£"><a href="#_2-2-componentscan-æ³¨è§£" class="header-anchor">#</a> 2.2. @ComponentScan æ³¨è§£</h3> <p>åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œæ›´å¤šçš„æ˜¯ä½¿ç”¨ Spring çš„åŒ…æ‰«æåŠŸèƒ½å¯¹é¡¹ç›®ä¸­çš„åŒ…è¿›è¡Œæ‰«æï¼Œå‡¡æ˜¯åœ¨æŒ‡å®šçš„åŒ…åŠå…¶å­åŒ…ä¸­æ ‡æ³¨äº† <code>@Repository</code>ã€<code>@Service</code>ã€<code>@Controller</code> å’Œ <code>@Component</code> æ³¨è§£çš„ç±»éƒ½ä¼šè¢«æ‰«æåˆ°ï¼Œç„¶åæ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚</p> <p>å…ˆæ¥å›é¡¾ä¸€ä¸‹å¦‚ä½• XML é…ç½®æ–‡ä»¶ä¸­é…ç½®åŒ…æ‰«æã€‚åˆ›å»ºä¸‰ä¸ªåˆ†åˆ«ä½¿ç”¨ <code>@Repository</code>ã€<code>@Service</code>ã€<code>@Controller</code> æ³¨è§£æ ‡æ³¨çš„ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Repository</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookRepository</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookService</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Controller</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookController</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>ç„¶ååœ¨ Spring æ ¸å¿ƒé…ç½®æ–‡ä»¶ <code>applicationContext.xml</code> å¢åŠ åŒ…æ‰«ææ ‡ç­¾ <code>&lt;context:component-scan base-package=&quot;&quot;/&gt;</code>ã€‚</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/context<span class="token punctuation">&quot;</span></span> 
       <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans  
       http://www.springframework.org/schema/beans/spring-beans.xsd 
       http://www.springframework.org/schema/context 
       https://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>person<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation.bean.Person<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xiaorang<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>è¿è¡Œ <code>SpringXmlConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤º: åªè¦æ˜¯åœ¨ <code>top.xiaorang.spring.annotation</code> åŒ…åŠå…¶å­åŒ…ä¸‹æ ‡æ³¨äº† <code>@Repository</code>ã€<code>@Service</code>ã€<code>@Controller</code> å’Œ <code>@Component</code> æ³¨è§£çš„ç±»éƒ½è¢«æ‰«æåˆ°ï¼Œç„¶åæ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126378.png" loading="lazy" class="lazy"></p> <p>ç°åœ¨å¼€å§‹ä½¿ç”¨ <code>@ComponentScan</code> æ³¨è§£æ¥é…ç½®åŒ…æ‰«æã€‚éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨é…ç½®ç±» <code>MainConfig</code> ä¸ŠåŠ ä¸Š <code>@ComponentScan</code> æ³¨è§£ï¼Œç„¶åæŒ‡å®šè¦æ‰«æçš„åŒ…è·¯å¾„å³å¯ã€‚å…·ä½“å®ç°è¿‡ç¨‹å¦‚ä¸‹ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126423.png" loading="lazy" class="lazy"></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Repeatable</span><span class="token punctuation">(</span><span class="token class-name">ComponentScans</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">ComponentScan</span> <span class="token punctuation">{</span>
	<span class="token comment">/**
		ç”¨äºæŒ‡å®šè¦æ‰«æçš„åŒ…ã€‚å½“æŒ‡å®šäº†åŒ…çš„åç§°ä¹‹åï¼Œspringä¼šæ‰«ææŒ‡å®šçš„åŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰ç±»ã€‚
	 */</span>
	<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;basePackages&quot;</span><span class="token punctuation">)</span>
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
  	å®ƒå’Œvalueä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚
	 */</span>
	<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">basePackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	  	æŒ‡å®šå…·ä½“è¦æ‰«æçš„ç±»çš„å­—èŠ‚ç ã€‚
	 */</span>
	<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">basePackageClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	  	æŒ‡å®šæ‰«æbeanå¯¹è±¡å­˜å…¥å®¹å™¨æ—¶çš„å‘½åè§„åˆ™ã€‚
	 */</span>
	<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">BeanNameGenerator</span><span class="token punctuation">&gt;</span></span> <span class="token function">nameGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">BeanNameGenerator</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	 */</span>
	<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ScopeMetadataResolver</span><span class="token punctuation">&gt;</span></span> <span class="token function">scopeResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">AnnotationScopeMetadataResolver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	 */</span>
	<span class="token class-name">ScopedProxyMode</span> <span class="token function">scopedProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">ScopedProxyMode</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	 */</span>
	<span class="token class-name">String</span> <span class="token function">resourcePattern</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">ClassPathScanningCandidateComponentProvider</span><span class="token punctuation">.</span><span class="token constant">DEFAULT_RESOURCE_PATTERN</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	  	æ˜¯å¦å¯¹å¸¦æœ‰@Component @Repository @Service @Controlleræ³¨è§£çš„ç±»å¼€å¯æ£€æµ‹,é»˜è®¤æ˜¯å¼€å¯çš„ã€‚
	 */</span>
	<span class="token keyword">boolean</span> <span class="token function">useDefaultFilters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	  	è‡ªå®šä¹‰ç»„ä»¶æ‰«æçš„è¿‡æ»¤è§„åˆ™ï¼Œç”¨ä»¥æ‰«æç»„ä»¶ã€‚
			FilterTypeæœ‰5ç§ç±»å‹ï¼š
	            ANNOTATION, æ³¨è§£ç±»å‹ é»˜è®¤
	            ASSIGNABLE_TYPE,æŒ‡å®šå›ºå®šç±»
	            ASPECTJï¼Œ ASPECTJç±»å‹
	            REGEX,æ­£åˆ™è¡¨è¾¾å¼
	            CUSTOM,è‡ªå®šä¹‰ç±»å‹
	 */</span>
	<span class="token class-name">Filter</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">includeFilters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	  	è‡ªå®šä¹‰ç»„ä»¶æ‰«æçš„æ’é™¤è§„åˆ™ã€‚
	 */</span>
	<span class="token class-name">Filter</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">excludeFilters</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  	<span class="token comment">/**
	  	ç»„ä»¶æ‰«ææ—¶æ˜¯å¦é‡‡ç”¨æ‡’åŠ è½½ ï¼Œé»˜è®¤ä¸å¼€å¯ã€‚
	 */</span>
	<span class="token keyword">boolean</span> <span class="token function">lazyInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
		<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token annotation punctuation">@interface</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
			<span class="token comment">/**
			 */</span>
			<span class="token class-name">FilterType</span> <span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">;</span>
	
			<span class="token comment">/**
			 */</span>
			<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;classes&quot;</span><span class="token punctuation">)</span>
			<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	      
			<span class="token comment">/**
			 */</span>
			<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
			<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">classes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	      
			<span class="token comment">/**
			 */</span>
			<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">pattern</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br></div></div><p>ç€é‡æ¥åˆ†æä¸‹ <code>@ComponentScan</code> æ³¨è§£ä¸­çš„ <code>includeFilters</code> å’Œ <code>excludeFilters</code> ä¸¤ä¸ªå±æ€§ã€‚å…¶ä¸­ï¼Œ <code>includeFilters</code> å±æ€§ç”¨äºæŒ‡å®šåŒ…æ‰«ææ—¶æŒ‰ç…§ä»€ä¹ˆè¿‡æ»¤è§„åˆ™å»æ³¨å†Œç»„ä»¶ï¼›è€Œ <code>excludeFilters</code> å±æ€§ç”¨äºæŒ‡å®šåŒ…æ‰«ææ—¶æŒ‰ç…§ä»€ä¹ˆè¿‡æ»¤è§„åˆ™å»æ’é™¤ç»„ä»¶ã€‚</p> <h4 id="_2-2-1-ç»†èŠ‚åˆ†æ-1-æŒ‰ç…§è¿‡æ»¤è§„åˆ™æ³¨å†Œç»„ä»¶"><a href="#_2-2-1-ç»†èŠ‚åˆ†æ-1-æŒ‰ç…§è¿‡æ»¤è§„åˆ™æ³¨å†Œç»„ä»¶" class="header-anchor">#</a> 2.2.1. ç»†èŠ‚åˆ†æ 1ï¼šæŒ‰ç…§è¿‡æ»¤è§„åˆ™æ³¨å†Œç»„ä»¶</h4> <p>åœ¨ <code>MainConfig</code> é…ç½®ç±»æ ‡æ³¨çš„ <code>@ComponentScan</code> æ³¨è§£ä¸­é…ç½® <code>includeFilters</code> å±æ€§ï¼šè®©å…¶åªæ‰«æè¢« <code>@Controller</code> æ³¨è§£æ ‡æ³¨çš„ç±»å’Œ <code>BookService</code> ç±»ï¼Œè¿™æ ·åšçš„è¯ï¼Œç†è®ºä¸Šï¼Œ<code>BookRepository</code> ç±»ä¸ä¼šè¢«æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚<br>
é…ç½®ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126225.png" loading="lazy" class="lazy"><br>
å‘ç° <code>BookRepository</code> è¿˜æ˜¯è‡ªåŠ¨æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ï¼Œä¸ºä»€ä¹ˆçŒœæƒ³ä¸å¯¹å‘¢ï¼Ÿå…¶å®ï¼Œåœ¨åˆ†æ <code>@ComponentScan</code> æ³¨è§£æºç çš„æ—¶å€™ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå±æ€§ï¼Œ<code>useDefaultFilters</code> ï¼Œæ˜¯å¦å¯¹å¸¦æœ‰ <code>@Repository</code>ã€<code>@Service</code>ã€<code>@Controller</code> å’Œ <code>@Component</code> æ³¨è§£çš„ç±»å¼€å¯æ£€æµ‹ï¼Œé»˜è®¤æ˜¯å¼€å¯çš„ã€‚è¦æƒ³ <code>includeFilters</code> å±æ€§è¾¾åˆ°é¢„æœŸæ•ˆæœï¼Œå°±éœ€è¦å°† <code>useDefaultFilters</code> å±æ€§ç½®ä¸º falseã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š  å‘ç°åªæœ‰ <code>BookController</code> å’Œ <code>BookService</code> è¢«æ‰«æåˆ° Spring å®¹å™¨ä¸­ï¼Œç›¸å½“äºé—´æ¥å°† <code>BookRepository</code> è¢«æ’é™¤åœ¨å¤–ã€‚<br> <img alt="" data-src="attachments/Pasted%20image%2020220828040106.png" loading="lazy" class="lazy"></p> <h4 id="_2-2-2-ç»†èŠ‚åˆ†æ-2-æŒ‰ç…§è¿‡æ»¤è§„åˆ™æ’é™¤ç»„ä»¶"><a href="#_2-2-2-ç»†èŠ‚åˆ†æ-2-æŒ‰ç…§è¿‡æ»¤è§„åˆ™æ’é™¤ç»„ä»¶" class="header-anchor">#</a> 2.2.2. ç»†èŠ‚åˆ†æ 2ï¼šæŒ‰ç…§è¿‡æ»¤è§„åˆ™æ’é™¤ç»„ä»¶</h4> <p>åœ¨ <code>MainConfig</code> é…ç½®ç±»æ ‡æ³¨çš„ <code>@ComponentScan</code> æ³¨è§£ä¸­é…ç½® <code>excludeFilters</code> å±æ€§ï¼šä¸æ‰«æè¢« <code>@Service</code> æ³¨è§£æ ‡æ³¨çš„ç±»ï¼Œè¿™æ ·åšçš„è¯ï¼Œç†è®ºä¸Šï¼Œç°åœ¨å°±åªå‰©ä¸‹ <code>BookController</code> ç±»ä¼šè¢«æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126422.png" loading="lazy" class="lazy"></p> <h4 id="_2-2-3-ç»†èŠ‚åˆ†æ-3-è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™"><a href="#_2-2-3-ç»†èŠ‚åˆ†æ-3-è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™" class="header-anchor">#</a> 2.2.3. ç»†èŠ‚åˆ†æ 3ï¼šè‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™</h4> <p>ç»„ä»¶æ‰«æçš„è¿‡æ»¤è§„åˆ™æœ‰ 5 ç§ï¼Œä½äº FilterType æšä¸¾ç±»ä¸­ã€‚</p> <ul><li>ANNOTATIONï¼Œæ³¨è§£ç±»å‹ é»˜è®¤</li> <li>ASSIGNABLE_TYPEï¼ŒæŒ‡å®šå›ºå®šç±»</li> <li>ASPECTJï¼ŒASPECTJ è¡¨è¾¾å¼</li> <li>REGEXï¼Œæ­£åˆ™è¡¨è¾¾å¼</li> <li>CUSTOMï¼Œè‡ªå®šä¹‰ç±»å‹<br>
å‰é¢å››ç§è¿‡æ»¤è§„åˆ™éƒ½å®ç°äº† <code>TypeFilter</code> æ¥å£ï¼Œå¹¶ä¸”éƒ½æœ‰é»˜è®¤çš„å®ç°ç±»ã€‚å¦‚æœæƒ³è¦è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™çš„è¯ï¼Œä¹Ÿéœ€è¦å®ç° <code>TypeFilter</code> æ¥å£ã€‚<br>
éœ€æ±‚ï¼šå°†æ ‡æ³¨äº†è‡ªå®šä¹‰æ³¨è§£ <code>@MyComponent</code> çš„ç±»ä¹Ÿæ‰«æåˆ° Spring å®¹å™¨ä¸­ã€‚</li></ul> <h5 id="_2-2-3-1-è‡ªå®šä¹‰æ³¨è§£"><a href="#_2-2-3-1-è‡ªå®šä¹‰æ³¨è§£" class="header-anchor">#</a> 2.2.3.1. è‡ªå®šä¹‰æ³¨è§£</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Documented</span>  
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">MyComponent</span> <span class="token punctuation">{</span>  
    <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="_2-2-3-2-æ ‡æ³¨è‡ªå®šä¹‰æ³¨è§£çš„ç±»"><a href="#_2-2-3-2-æ ‡æ³¨è‡ªå®šä¹‰æ³¨è§£çš„ç±»" class="header-anchor">#</a> 2.2.3.2. æ ‡æ³¨è‡ªå®šä¹‰æ³¨è§£çš„ç±»</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>â€‹```java
@MyComponent  
public class Man {  
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="_2-2-3-3-è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™"><a href="#_2-2-3-3-è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™" class="header-anchor">#</a> 2.2.3.3. è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™</h5> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTypeFilter</span> <span class="token keyword">implements</span> <span class="token class-name">TypeFilter</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">match</span><span class="token punctuation">(</span><span class="token class-name">MetadataReader</span> metadataReader<span class="token punctuation">,</span> <span class="token class-name">MetadataReaderFactory</span> metadataReaderFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>  
        <span class="token class-name">AnnotationMetadata</span> annotationMetadata <span class="token operator">=</span> metadataReader<span class="token punctuation">.</span><span class="token function">getAnnotationMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> annotationMetadata<span class="token punctuation">.</span><span class="token function">hasAnnotation</span><span class="token punctuation">(</span><span class="token class-name">MyComponent</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="_2-2-3-4-ä¿®æ”¹é…ç½®ç±»"><a href="#_2-2-3-4-ä¿®æ”¹é…ç½®ç±»" class="header-anchor">#</a> 2.2.3.4. ä¿®æ”¹é…ç½®ç±»</h5> <p>åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šï¼Œ<code>includeFilters</code> å±æ€§ä¸­å¢åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„è¿‡æ»¤è§„åˆ™ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126409.png" loading="lazy" class="lazy"></p> <h4 id="_2-2-4-ç»†èŠ‚åˆ†æ-4-é‡å¤æ³¨è§£"><a href="#_2-2-4-ç»†èŠ‚åˆ†æ-4-é‡å¤æ³¨è§£" class="header-anchor">#</a> 2.2.4. ç»†èŠ‚åˆ†æ 4ï¼šé‡å¤æ³¨è§£</h4> <p>ä¸çŸ¥é“æœ‰æ²¡æœ‰ç»†å¿ƒçš„å°ä¼™ä¼´æ³¨æ„åˆ° <code>@ComponentScan</code> æ³¨è§£ä¸Šæœ‰ä¸€ä¸ª <code>@Repeatable</code> æ³¨è§£ï¼Œ<code>@Repeatable</code> æ³¨è§£æ˜¯åœ¨ JDK1.8 å‡ºç°çš„ï¼Œä½œç”¨æ˜¯ <strong>å¯ä»¥åœ¨ä¸€ä¸ªç±»ä¸Šæ ‡æ³¨é‡å¤çš„æ³¨è§£</strong>ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Documented</span>  
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION_TYPE</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Repeatable</span> <span class="token punctuation">{</span>  
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Annotation</span><span class="token punctuation">&gt;</span></span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>@Repeatable</code> æ³¨è§£ä¸­çš„ <code>value</code> å±æ€§å€¼ä¸ºä¸€ä¸ª <code>@ComponentScans</code> æ³¨è§£ç±»ã€‚ <code>@ComponentScans</code> æ³¨è§£å†…éƒ¨åªå£°æ˜äº†ä¸€ä¸ªè¿”å› <code>ComponentScan</code> æ³¨è§£æ•°ç»„çš„ <code>value</code> å±æ€§ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Documented</span>  
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">ComponentScans</span> <span class="token punctuation">{</span>  
   <span class="token class-name">ComponentScan</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åœ¨ç°åœ¨çš„é…ç½®ç±»ä¸Šæ ‡æ³¨å¤šä¸ª <code>@ComponentScan</code> æ³¨è§£ï¼Œä¿®æ”¹ä¸€ä¸‹ç°æœ‰çš„é…ç½®ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126463.png" loading="lazy" class="lazy"></p> <h3 id="_2-3-scope-æ³¨è§£"><a href="#_2-3-scope-æ³¨è§£" class="header-anchor">#</a> 2.3. @Scope æ³¨è§£</h3> <p>Spring å®¹å™¨ä¸­çš„ç»„ä»¶ <strong>é»˜è®¤æ˜¯å•ä¾‹çš„</strong>ï¼Œåœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™å°±ä¼šå»å®ä¾‹åŒ–å¹¶åˆå§‹åŒ–å¯¹è±¡ï¼Œå¹¶å°†å…¶å­˜æ”¾åˆ°å®¹å™¨å½“ä¸­ï¼Œä¹‹åæ¯æ¬¡è·å–ç»„ä»¶æ—¶ï¼Œå°±ç›´æ¥ä» Spring å®¹å™¨ä¸­è·å–ï¼Œè€Œä¸ç”¨å†åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚å¦‚æœè¯´ï¼Œä»å®¹å™¨ä¸­è·å–ç»„ä»¶æ—¶å°±æ˜¯æƒ³è·å–ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæ­¤æ—¶å°±éœ€è¦ç”¨åˆ° <strong><code>@Scope</code> æ³¨è§£æ¥è®¾ç½®ç»„ä»¶çš„ä½œç”¨åŸŸ</strong>ã€‚<code>@Scope</code> æ³¨è§£ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ <code>bean</code> æ ‡ç­¾çš„ <code>scope</code> å±æ€§ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Scope</span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * Alias for {@link #scopeName}.
	 * @see #scopeName
	 */</span>
	<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;scopeName&quot;</span><span class="token punctuation">)</span>
	<span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * Specifies the name of the scope to use for the annotated component/bean.
	 * &lt;p&gt;Defaults to an empty string ({@code &quot;&quot;}) which implies
	 * {@link ConfigurableBeanFactory#SCOPE_SINGLETON SCOPE_SINGLETON}.
	 * @since 4.2
	 * @see ConfigurableBeanFactory#SCOPE_PROTOTYPE
	 * @see ConfigurableBeanFactory#SCOPE_SINGLETON
	 * @see org.springframework.web.context.WebApplicationContext#SCOPE_REQUEST
	 * @see org.springframework.web.context.WebApplicationContext#SCOPE_SESSION
	 * @see #value
	 */</span>
	<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
	<span class="token class-name">String</span> <span class="token function">scopeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token class-name">ScopedProxyMode</span> <span class="token function">proxyMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">ScopedProxyMode</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><ul><li>SCOPE_PROTOTYPEï¼šå¤šå®ä¾‹ï¼Œå®¹å™¨å¯åŠ¨æ—¶å¹¶ä¸ä¼šå®ä¾‹åŒ–å¯¹è±¡ï¼Œè€Œæ˜¯åœ¨æ¯æ¬¡ä»å®¹å™¨è·å–å¯¹è±¡æ—¶éƒ½å»åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡è¿”å›ã€‚</li> <li>SCOPE_SINGLETONï¼šå•å®ä¾‹ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œå®¹å™¨å¯åŠ¨çš„æ—¶å€™å°±ä¼šå»å®ä¾‹åŒ–å¹¶åˆå§‹åŒ–ç»„ä»¶ï¼Œå¹¶å°†å…¶å­˜æ”¾åˆ°å®¹å™¨å½“ä¸­ã€‚</li> <li>SCOPE_REQUESTï¼šéœ€è¦å¤„åœ¨ web ç¯å¢ƒä¸‹æ‰èƒ½ç”Ÿæ•ˆï¼Œè¡¨ç¤ºæ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡ï¼Œä½†æ˜¯åœ¨åŒä¸€æ¬¡è¯·æ±‚ä¸­åªä¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚</li> <li>SCOPE_SESSIONï¼šéœ€è¦å¤„åœ¨ web ç¯å¢ƒä¸‹æ‰èƒ½ç”Ÿæ•ˆï¼Œè¡¨ç¤ºåœ¨åŒä¸€ä¸ª session èŒƒå›´å†…ï¼Œåªä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡ã€‚</li></ul> <h4 id="_2-3-1-å•å®ä¾‹-bean-ä½œç”¨åŸŸ"><a href="#_2-3-1-å•å®ä¾‹-bean-ä½œç”¨åŸŸ" class="header-anchor">#</a> 2.3.1. å•å®ä¾‹ bean ä½œç”¨åŸŸ</h4> <p>é…ç½®ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>æµ‹è¯•ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationOfScopeTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationOfScopeTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å®¹å™¨å¯åŠ¨ä¹‹åï¼Œè·å–Personç»„ä»¶ä¹‹å‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Person</span> person <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Person</span> person2 <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ˜¯å¦åŒä¸€ä¸ªpersonå®ä¾‹ï¼Ÿ{}&quot;</span><span class="token punctuation">,</span> person <span class="token operator">==</span> person2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126449.png" loading="lazy" class="lazy"><br>
ç»“æœè¡¨æ˜ï¼š<strong>å®¹å™¨ä¸­çš„ç»„ä»¶é»˜è®¤æ˜¯å•å®ä¾‹çš„ï¼Œåœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™å°±ä¼šå»å®ä¾‹åŒ–å¹¶åˆå§‹åŒ–ç»„ä»¶ï¼Œå¹¶å°†å…¶å­˜æ”¾åˆ°å®¹å™¨å½“ä¸­ï¼Œä¹‹åæ¯æ¬¡ä»å®¹å™¨ä¸­è·å–åˆ°çš„å®ä¾‹å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ª</strong>ã€‚<br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå•ä¾‹å¯¹è±¡æ˜¯æ•´ä¸ªåº”ç”¨å…±äº«çš„ï¼Œæ‰€ä»¥éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p> <h4 id="_2-3-2-å¤šå®ä¾‹-bean-ä½œç”¨åŸŸ"><a href="#_2-3-2-å¤šå®ä¾‹-bean-ä½œç”¨åŸŸ" class="header-anchor">#</a> 2.3.2. å¤šå®ä¾‹ bean ä½œç”¨åŸŸ</h4> <p>ä¿®æ”¹åŸæœ‰çš„é…ç½®ç±»ï¼Œåœ¨ <code>@Bean</code> æ³¨è§£æ ‡æ³¨çš„ <code>person()</code> ä¸ŠåŠ ä¸Š <code>@Scope</code> æ³¨è§£ï¼Œå¹¶ä¸” <code>value</code> å±æ€§å€¼ä¸º <code>prototype</code>ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;prototype&quot;</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>æµ‹è¯•ä»£ç ä¸å˜ï¼Œè¿è¡Œ <code>SpringAnnotationConfigurationOfScopeTest</code> æµ‹è¯•ç±»ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120126677.png" loading="lazy" class="lazy"><br>
ç»“æœè¡¨æ˜ï¼š<strong>å®¹å™¨å¯åŠ¨æ—¶å¹¶ä¸ä¼šå®ä¾‹åŒ–å¯¹è±¡ï¼Œè€Œæ˜¯åœ¨æ¯æ¬¡ä»å®¹å™¨è·å–å¯¹è±¡æ—¶éƒ½å»åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡è¿”å›</strong>ã€‚</p> <h3 id="_2-4-lazy-æ³¨è§£"><a href="#_2-4-lazy-æ³¨è§£" class="header-anchor">#</a> 2.4. @Lazy æ³¨è§£</h3> <p>Spring å®¹å™¨å¯åŠ¨æ—¶ï¼Œé»˜è®¤ä¼šå°†å•å®ä¾‹ bean è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¹¶åŠ è½½åˆ°å®¹å™¨å½“ä¸­ã€‚å¦‚æœéœ€è¦å°†æŸä¸ªå•å®ä¾‹ bean è¿›è¡Œå»¶è¿ŸåŠ è½½ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæ­¤æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ° <code>@Lazy</code> æ³¨è§£ã€‚<br>
ä½•ä¸ºæ‡’åŠ è½½ï¼Ÿæ‡’åŠ è½½ä¹Ÿç§°å»¶æ—¶åŠ è½½ï¼Œ<strong>ä»…é’ˆå¯¹å•å®ä¾‹ bean ç”Ÿæ•ˆ</strong>ã€‚è®©å•å®ä¾‹ bean åœ¨ Spring å®¹å™¨å¯åŠ¨æ—¶ï¼Œå…ˆä¸è¿›è¡Œå®ä¾‹åŒ–ï¼Œè€Œæ˜¯ç­‰åˆ°ç¬¬ä¸€æ¬¡è·å–è¯¥ bean å®ä¾‹æ—¶æ‰è¿›è¡Œå®ä¾‹åŒ–å’Œåˆå§‹åŒ–ï¼Œç„¶ååŠ è½½åˆ° Spring å®¹å™¨ä¸­å¹¶è¿”å›è¯¥å•å®ä¾‹ beanã€‚</p> <p>ä¿®æ”¹åŸæœ‰çš„é…ç½®ç±»ï¼Œåœ¨ <code>@Bean</code> æ³¨è§£æ ‡æ³¨çš„ <code>person()</code> ä¸ŠåŠ ä¸Š <code>@Lazy</code> æ³¨è§£ï¼ŒåŒæ—¶å»æ‰å‰é¢åŠ ä¸Šçš„ <code>@Scope</code> æ³¨è§£ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Lazy</span>  
    <span class="token annotation punctuation">@Bean</span>    
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>æµ‹è¯•ä»£ç ä¸å˜ï¼Œè¿è¡Œ <code>SpringAnnotationConfigurationOfScopeTest</code> æµ‹è¯•ç±»ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120127097.png" loading="lazy" class="lazy"></p> <h3 id="_2-5-conditional-æ³¨è§£"><a href="#_2-5-conditional-æ³¨è§£" class="header-anchor">#</a> 2.5. @Conditional æ³¨è§£</h3> <p>Spring æ”¯æŒæ ¹æ®æ¡ä»¶å‘å®¹å™¨ä¸­æ³¨å†Œ beanï¼Œæ»¡è¶³æ¡ä»¶çš„ bean æ‰ä¼šè¢«æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚é‚£ä¹ˆåœ¨ Spring ä¸­æ˜¯å¦‚ä½•å®ç°æ ¹æ®æ¡ä»¶å‘å®¹å™¨ä¸­æ³¨å†Œ bean çš„å‘¢ï¼Ÿæ­¤æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ° <code>@Conditional</code> æ³¨è§£ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Conditional</span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * All {@link Condition Conditions} that must {@linkplain Condition#matches match}
	 * in order for the component to be registered.
	 */</span>
	<span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Condition</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>ä» <code>@Conditional</code> æ³¨è§£çš„æºç æ¥çœ‹ï¼Œ<code>@Conditional</code> æ³¨è§£ä¸ä»…å¯ä»¥åœ¨ä½œç”¨åœ¨ç±»ä¸Šï¼Œä¹Ÿå¯ä»¥ä½œç”¨åœ¨æ–¹æ³•ä¸Šã€‚<code>@Conditional</code> æ³¨è§£æœ‰ä¸€ä¸ª <code>value</code> å±æ€§ï¼Œç±»å‹ä¸º <code>Condition</code> æ¥å£æ•°ç»„ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>  
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Condition</span> <span class="token punctuation">{</span>  
	<span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">ConditionContext</span> context<span class="token punctuation">,</span> <span class="token class-name">AnnotatedTypeMetadata</span> metadata<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æ‰€æœ‰è‡ªå®šä¹‰æ¡ä»¶éƒ½éœ€è¦å®ç°è¯¥æ¥å£ï¼Œé‡å†™å…¶ä¸­çš„ matches æ–¹æ³•ï¼Œå½“è¿”å›å€¼ä¸º true æ—¶ï¼Œæ‰ä¼šå°†è¢«æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚<br>
ç°åœ¨ï¼Œæå‡ºä¸€ä¸ªæ–°çš„éœ€æ±‚ï¼šå¦‚æœå½“å‰ç³»ç»Ÿæ˜¯ Windows ç³»ç»Ÿé‚£ä¹ˆå°±å‘ Spring å®¹å™¨ä¸­æ³¨å†Œåç§°ä¸º bill çš„ <code>Person</code> å¯¹è±¡ï¼›å¦‚æœå½“å‰ç³»ç»Ÿæ˜¯ Linux ç³»ç»Ÿï¼Œé‚£ä¹ˆå°±å‘ Spring å®¹å™¨ä¸­æ³¨å†Œåç§°ä¸º linus çš„ <code>Person</code> å¯¹è±¡ã€‚<br>
è‡ªå®šä¹‰æ¡ä»¶ <code>WindowsCondition</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WindowsCondition</span> <span class="token keyword">implements</span> <span class="token class-name">Condition</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">ConditionContext</span> context<span class="token punctuation">,</span> <span class="token class-name">AnnotatedTypeMetadata</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">Environment</span> environment <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> property <span class="token operator">=</span> environment<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;os.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>property<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;Windows&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è‡ªå®šä¹‰æ¡ä»¶ <code>LinuxCondition</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LinuxCondition</span> <span class="token keyword">implements</span> <span class="token class-name">Condition</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">matches</span><span class="token punctuation">(</span><span class="token class-name">ConditionContext</span> context<span class="token punctuation">,</span> <span class="token class-name">AnnotatedTypeMetadata</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">Environment</span> environment <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span> property <span class="token operator">=</span> environment<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;os.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>property<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;Linux&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä¿®æ”¹åŸæœ‰çš„é…ç½®ç±»ï¼Œå¢åŠ ä¸¤ä¸ªè¢« <code>@Bean</code> æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ï¼Œè¿”å›å€¼ç±»å‹ä¸º <code>Person</code> ç±»å‹ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Lazy</span>  
    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">WindowsCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;bill&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personï¼ˆbillï¼‰ç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;bill&quot;</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">LinuxCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;linus&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personï¼ˆlinusï¼‰ç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;linus&quot;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>ç°åœ¨ä½¿ç”¨çš„æ˜¯ Windows ç³»ç»Ÿï¼Œæ‰€ä»¥åªä¼šå‘å®¹å™¨ä¸­æ³¨å†Œ bill çš„ç»„ä»¶ã€‚è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120127605.png" loading="lazy" class="lazy"><br>
ç°åœ¨å°†è¿è¡Œç¯å¢ƒæ”¹æˆ Linux ç¯å¢ƒï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿæ‰“å¼€ Run/Debug Configurations =&gt; æ·»åŠ  JVM å‚æ•° <code>-Dos.name=Linux</code>ã€‚<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120127824.png" loading="lazy" class="lazy"><br>
ç°åœ¨è¿è¡Œç¯å¢ƒå°±å˜æˆ Linux ç³»ç»Ÿç¯å¢ƒï¼Œè¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120127529.png" loading="lazy" class="lazy"><br>
åªå‘å®¹å™¨ä¸­æ³¨å†Œ linus çš„ç»„ä»¶ï¼Œè€Œæ²¡æœ‰å°† bill ç»„ä»¶æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚</p> <h3 id="_2-6-import-æ³¨è§£"><a href="#_2-6-import-æ³¨è§£" class="header-anchor">#</a> 2.6. @Import æ³¨è§£</h3> <p>åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œè‡ªå·±å†™çš„ç±»å¯ä»¥é€šè¿‡åŒ…æ‰«æ (<code>@ComponentScan</code>)+ ç»„ä»¶æ ‡æ³¨æ³¨è§£ (<code>@Controller</code>ã€<code>@Service</code>ã€<code>@Repository</code>ã€<code>@Component</code>) çš„å½¢å¼å°† bean å¯¹è±¡æ³¨å†Œåˆ° Spring å®¹å™¨å½“ä¸­ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼æ¯”è¾ƒæœ‰å±€é™æ€§ï¼Œåªèƒ½æ˜¯è‡ªå·±å†™çš„ç±»ï¼Œæ‰èƒ½æ ‡æ³¨ä»¥ä¸Šçš„æ³¨è§£ã€‚å¦‚æœä¸æ˜¯è‡ªå·±å†™çš„ç±»ï¼Œå¦‚å¼•å…¥çš„ä¸€äº›ç¬¬ä¸‰æ–¹ç±»åº“ä¸­çš„ç±»ï¼Œé‚£ä¹ˆå¦‚ä½•å°†è¿™æ ·çš„ç±»æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­å‘¢ï¼Ÿå‰é¢å·²ç»æåˆ°è¿‡ä¸€ç§è§£å†³æ–¹æ³•ï¼š<code>@Configuration</code> + <code>@Bean</code>ï¼Œç°åœ¨ä»‹ç»å¦å¤–ä¸€ç§æ–¹æ³•ï¼šä½¿ç”¨ <code>@Import</code> æ³¨è§£å¿«é€Ÿå‘ Spring å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Documented</span>  
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Import</span> <span class="token punctuation">{</span>  
   <span class="token comment">/**  
    * {@link Configuration @Configuration}, {@link ImportSelector},  
    * {@link ImportBeanDefinitionRegistrar}, or regular component classes to import.  
    */</span>   
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>@Import</code> æ³¨è§£åªèƒ½ä½œç”¨åœ¨ç±»ä¸Šï¼Œé€šå¸¸éƒ½æ˜¯å’Œé…ç½®ç±»ä¸€èµ·ä½¿ç”¨ã€‚ä»æºç ä¸­å¯ä»¥çœ‹å‡º <code>@Import</code> æ³¨è§£ä¸­çš„ <code>value</code> å±æ€§å¯ä»¥ä½¿ç”¨æ ‡æ³¨ <code>@Configuration</code> æ³¨è§£çš„ç±»ã€å®ç° <code>ImportSelector</code> æ¥å£çš„ç±»ã€å®ç° <code>ImportBeanDefinitionRegistrar</code> æ¥å£çš„ç±»æˆ–è€…ä¸€ä¸ªç®€å•çš„ç±»éƒ½å¯ä»¥ã€‚</p> <h4 id="_2-6-1-ç®€å•çš„ç±»"><a href="#_2-6-1-ç®€å•çš„ç±»" class="header-anchor">#</a> 2.6.1. ç®€å•çš„ç±»</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Color</span> <span class="token punctuation">{</span>  

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä¿®æ”¹åŸæœ‰çš„é…ç½®ç±»ï¼Œåœ¨ç±»ä¸Šæ ‡æ³¨ <code>@Import</code> æ³¨è§£</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">Color</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Lazy</span>  
    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">WindowsCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;bill&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personï¼ˆbillï¼‰ç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;bill&quot;</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">LinuxCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;linus&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personï¼ˆlinusï¼‰ç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;linus&quot;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120127759.png" loading="lazy" class="lazy"></p> <h4 id="_2-6-2-importselector-æ¥å£"><a href="#_2-6-2-importselector-æ¥å£" class="header-anchor">#</a> 2.6.2. ImportSelector æ¥å£</h4> <p><code>ImportSelector</code> æ¥å£æ˜¯ Spring ä¸­å¯¼å…¥å¤–éƒ¨é…ç½®çš„æ ¸å¿ƒæ¥å£ã€‚ç°åœ¨æ¥çœ‹çœ‹ <code>ImportSelector</code> æ¥å£çš„æºç ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ImportSelector</span> <span class="token punctuation">{</span>  
  
   <span class="token comment">/**  
    * Select and return the names of which class(es) should be imported based on    
    * the {@link AnnotationMetadata} of the importing @{@link Configuration} class.  
    * @return the class names, or an empty array if none  
    */</span>   
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
   <span class="token comment">/**  
    * Return a predicate for excluding classes from the import candidates, to be    
    * transitively applied to all classes found through this selector's imports.    
    * &lt;p&gt;If this predicate returns {@code true} for a given fully-qualified  
    * class name, said class will not be considered as an imported configuration    
    * class, bypassing class file loading as well as metadata introspection.    
    * @return the filter predicate for fully-qualified candidate class names  
    * of transitively imported configuration classes, or {@code null} if none  
    * @since 5.2.4  
    */</span>   
	<span class="token annotation punctuation">@Nullable</span>  
	<span class="token keyword">default</span> <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getExclusionFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
	<span class="token punctuation">}</span>  
  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><code>ImportSelector</code> æ¥å£ä¸»è¦ä½œç”¨æ˜¯æ”¶é›†éœ€è¦å¯¼å…¥çš„é…ç½®ç±»ï¼Œå…¶ä¸­çš„ <code>selectImports()</code> æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯ <strong>éœ€è¦å‘ Spring å®¹å™¨ä¸­å¯¼å…¥çš„ç±»çš„<u>å®Œå…¨é™å®šå</u></strong>ã€‚å¦‚æœè¯¥æ¥å£çš„å®ç°ç±»åŒæ—¶å®ç° <code>EnvironmentAware</code>ã€<code>BeanFactoryAware</code>ã€<code>BeanClassLoaderAware</code> å’Œ <code>ResourceLoaderAware</code> æ¥å£ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨å…¶ <code>selectImports()</code> æ–¹æ³•ä¹‹å‰ä¼šå…ˆè°ƒç”¨ä¸Šè¿°æ¥å£ä¸­å¯¹åº”çš„æ–¹æ³•ï¼Œå¦‚æœéœ€è¦åœ¨æ‰€æœ‰çš„ <code>@Configuration</code> ç±»å¤„ç†å®Œå†å¯¼å…¥ï¼Œé‚£ä¹ˆå¯ä»¥å®ç° <code>DeferredImportSelector</code> æ¥å£ã€‚<br>
åœ¨ <code>selectImports()</code> æ–¹æ³•ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ª <code>AnnotationMetadata</code> ç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°èƒ½å¤Ÿè·å–åˆ°å½“å‰æ ‡æ³¨ <code>@Import</code> æ³¨è§£çš„ç±»çš„æ‰€æœ‰æ³¨è§£ä¿¡æ¯ï¼Œä¹Ÿå°±è¯´ä¸ä»…èƒ½è·å–åˆ° <code>@Import</code> æ³¨è§£é‡Œé¢çš„ä¿¡æ¯ï¼Œè¿˜èƒ½è·å–åˆ°ç±»ä¸Šå…¶ä»–æ³¨è§£çš„ä¿¡æ¯ã€‚</p> <p>éœ€æ±‚ï¼šä½¿ç”¨ <code>ImportSelector</code> æ¥å£çš„æ–¹å¼å‘ Spring å®¹å™¨ä¸­å¯¼å…¥ <code>yellow</code> å’Œ <code>blue</code> ä¸¤ä¸ªç»„ä»¶ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Yellow</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Blue</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>ImportSelector</code> æ¥å£å®ç°ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyImportSelector</span> <span class="token keyword">implements</span> <span class="token class-name">ImportSelector</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;top.xiaorang.spring.annotation.bean.yellow&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;top.xiaorang.spring.annotation.bean.Blue&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ä¿®æ”¹åŸæœ‰çš„é…ç½®ç±»ï¼Œåœ¨ç±»ä¸Šæ ‡æ³¨çš„ <code>@Import</code> æ³¨è§£çš„ <code>value</code> å±æ€§ä¸­å¢åŠ  <code>ImportSelector</code> æ¥å£çš„å®ç°ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">Color</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">MyImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Lazy</span>  
    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">WindowsCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;bill&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personï¼ˆbillï¼‰ç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;bill&quot;</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">LinuxCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;linus&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personï¼ˆlinusï¼‰ç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;linus&quot;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120127729.png" loading="lazy" class="lazy"></p> <h4 id="_2-6-3-importbeandefinitionregistrar-æ¥å£"><a href="#_2-6-3-importbeandefinitionregistrar-æ¥å£" class="header-anchor">#</a> 2.6.3. ImportBeanDefinitionRegistrar æ¥å£</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ImportBeanDefinitionRegistrar</span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * Register bean definitions as necessary based on the given annotation metadata of
	 * the importing {@code @Configuration} class.
	 * &lt;p&gt;Note that {@link BeanDefinitionRegistryPostProcessor} types may &lt;em&gt;not&lt;/em&gt; be
	 * registered here, due to lifecycle constraints related to {@code @Configuration}
	 * class processing.
	 * &lt;p&gt;The default implementation delegates to
	 * {@link #registerBeanDefinitions(AnnotationMetadata, BeanDefinitionRegistry)}.
	 * @param importingClassMetadata annotation metadata of the importing class
	 * @param registry current bean definition registry
	 * @param importBeanNameGenerator the bean name generator strategy for imported beans:
	 * {@link ConfigurationClassPostProcessor#IMPORT_BEAN_NAME_GENERATOR} by default, or a
	 * user-provided one if {@link ConfigurationClassPostProcessor#setBeanNameGenerator}
	 * has been set. In the latter case, the passed-in strategy will be the same used for
	 * component scanning in the containing application context (otherwise, the default
	 * component-scan naming strategy is {@link AnnotationBeanNameGenerator#INSTANCE}).
	 * @since 5.2
	 * @see ConfigurationClassPostProcessor#IMPORT_BEAN_NAME_GENERATOR
	 * @see ConfigurationClassPostProcessor#setBeanNameGenerator
	 */</span>
	<span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">,</span>
			<span class="token class-name">BeanNameGenerator</span> importBeanNameGenerator<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span>importingClassMetadata<span class="token punctuation">,</span> registry<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * Register bean definitions as necessary based on the given annotation metadata of
	 * the importing {@code @Configuration} class.
	 * &lt;p&gt;Note that {@link BeanDefinitionRegistryPostProcessor} types may &lt;em&gt;not&lt;/em&gt; be
	 * registered here, due to lifecycle constraints related to {@code @Configuration}
	 * class processing.
	 * &lt;p&gt;The default implementation is empty.
	 * @param importingClassMetadata annotation metadata of the importing class
	 * @param registry current bean definition registry
	 */</span>
	<span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>ç”±æºç å¯ä»¥çœ‹å‡ºï¼Œåœ¨ <code>ImportBeanDefinitionRegistrar</code> æ¥å£ä¸­æœ‰ä¸€ä¸ª <code>registerBeanDefinitions()</code> æ–¹æ³•ï¼Œé€šè¿‡è¯¥æ–¹æ³•å¯ä»¥å‘ Spring å®¹å™¨æ³¨å†Œ bean çš„å®šä¹‰ä¿¡æ¯ï¼Œåç»­æ ¹æ® bean çš„å®šä¹‰ä¿¡æ¯å»åˆ›å»º bean çš„å®ä¾‹å¯¹è±¡ã€‚æ‰€æœ‰å®ç°äº† <code>ImportBeanDefinitionRegistrar</code> æ¥å£çš„ç±»éƒ½ä¼šè¢« <code>ConfigurationClassPostProcessor</code> å¤„ç†ï¼Œ<code>ConfigurationClassPostProcessor</code> å®ç°äº† <code>BeanFactoryPostProcessor</code> æ¥å£ã€‚<br>
ç°åœ¨çœ‹ä¸‹ <code>@Import</code> æ³¨è§£é…åˆ <code>ImportBeanDefinitionRegistrar</code> æ¥å£çš„å®ç°ç±»æ˜¯å¦‚ä½•å‘ Spring å®¹å™¨ä¸­æ³¨å†Œ bean çš„ï¼Ÿéœ€æ±‚ï¼šä½¿ç”¨ <code>ImportBeanDefinitionRegistrar</code> æ¥å£çš„æ–¹å¼å‘ Spring å®¹å™¨ä¸­å¯¼å…¥ <code>Rainbow</code> ç»„ä»¶ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rainbow</span> <span class="token punctuation">{</span> 

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>ImportBeanDefinitionRegistrar</code> æ¥å£å®ç°ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyImportBeanDefinitionRegistrar</span> <span class="token keyword">implements</span> <span class="token class-name">ImportBeanDefinitionRegistrar</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> importingClassMetadata<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">RootBeanDefinition</span> rootBeanDefinition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RootBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        rootBeanDefinition<span class="token punctuation">.</span><span class="token function">setBeanClass</span><span class="token punctuation">(</span><span class="token class-name">Rainbow</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        registry<span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;rainbow&quot;</span><span class="token punctuation">,</span> rootBeanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä¿®æ”¹åŸæœ‰çš„é…ç½®ç±»ï¼Œåœ¨ç±»ä¸Šæ ‡æ³¨çš„ <code>@Import</code> æ³¨è§£çš„ <code>value</code> å±æ€§ä¸­å¢åŠ  <code>ImportBeanDefinitionRegistrar</code> æ¥å£çš„å®ç°ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Controller</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MyTypeFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Service</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;top.xiaorang.spring.annotation&quot;</span><span class="token punctuation">,</span> includeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>  
        <span class="token annotation punctuation">@ComponentScan.Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FilterType</span><span class="token punctuation">.</span><span class="token constant">ASSIGNABLE_TYPE</span><span class="token punctuation">,</span> classes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BookRepository</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> useDefaultFilters <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>  
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">Color</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">MyImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">MyImportBeanDefinitionRegistrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">MainConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Lazy</span>  
    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">WindowsCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;bill&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personï¼ˆbillï¼‰ç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;bill&quot;</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">LinuxCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;linus&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å‘Springå®¹å™¨ä¸­æ·»åŠ Personï¼ˆlinusï¼‰ç»„ä»¶&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;linus&quot;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120127237.png" loading="lazy" class="lazy"></p> <h3 id="_2-7-factorybean"><a href="#_2-7-factorybean" class="header-anchor">#</a> 2.7. FactoryBean</h3> <p><code>FactoryBean</code> æ¥å£åœ¨ Spring æ¡†æ¶ä¸­å ç”¨éå¸¸é‡è¦çš„åœ°ä½ï¼ŒSpring è‡ªèº«å°±æä¾›äº†å¤§é‡çš„ <code>FactoryBean</code> æ¥å£å®ç°ã€‚å®ƒä»¬éšè—äº†å®ä¾‹åŒ–ä¸€äº›å¤æ‚å¯¹è±¡æ—¶çš„å…·ä½“ç»†èŠ‚ï¼Œç»™ä¸Šå±‚åº”ç”¨å¸¦æ¥äº†ä¾¿åˆ©ã€‚ åœ¨ Spring ä¸­æœ€ä¸ºå…¸å‹çš„ä¸€ä¸ª <code>FactoryBean</code> å®ç°å°±æ˜¯ <code>ProxyFactoryBean</code>ï¼Œ ç”¨æ¥åˆ›å»º AOP çš„ä»£ç†å¯¹è±¡ ï¼›ç”¨è¿‡ <code>Mybatis</code> çš„è‚¯å®šä¹ŸçŸ¥é“å¦ä¸€ä¸ª <code>FctoryBean</code> æ¥å£å®ç° <code>SqlSessionFactoryBean</code>ï¼Œç”¨æ¥åˆ›å»º <code>SqlSessionFactory</code> å¯¹è±¡ã€‚ä» Spring3.0 å¼€å§‹ï¼ŒFactoryBean å¼€å§‹æ”¯æŒæ³›å‹ï¼Œå³æ¥å£å£°æ˜æ”¹ä¸º <code>FactoryBean&lt;T&gt;</code> çš„å½¢å¼ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>  
    <span class="token class-name">String</span> <span class="token constant">OBJECT_TYPE_ATTRIBUTE</span> <span class="token operator">=</span> <span class="token string">&quot;factoryBeanObjectType&quot;</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Nullable</span>  
    <span class="token class-name">T</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Nullable</span>  
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getObjectType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">isSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>å…¶ä¸­ï¼Œ<code>getObject()</code> æ–¹æ³•è¿”å›åˆ›å»ºå‡ºæ¥çš„å®ä¾‹å¯¹è±¡ï¼›<code>getObjectType()</code> æ–¹æ³•è¿”å›å®ä¾‹å¯¹è±¡çš„å…·ä½“ç±»å‹ï¼›<code>isSingleton()</code> è¿”å›å®ä¾‹å¯¹è±¡çš„ä½œç”¨åŸŸæ˜¯å¦å•ä¾‹å¯¹è±¡ï¼Œæ˜¯å•ä¾‹å¯¹è±¡çš„è¯ï¼Œæ¯æ¬¡è°ƒç”¨ <code>getObject()</code> æ–¹æ³•è¿”å›çš„å®ä¾‹å¯¹è±¡æ˜¯åŒä¸€ä¸ªã€‚<br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå½“é…ç½®æ–‡ä»¶ä¸­ <code>bean</code> æ ‡ç­¾çš„ <code>class</code> å±æ€§ä¸º <code>FactoryBean</code> æ¥å£çš„å®ç°ç±»æ—¶ï¼Œé€šè¿‡ <code>getBean()</code> æ–¹æ³•è·å–çš„å®ä¾‹å¯¹è±¡ä¸æ˜¯ <code>FactoryBean</code> å®ç°ç±»ï¼Œè€Œæ˜¯ <code>FactoryBean#getObject()</code> æ–¹æ³•æ‰€è¿”å›çš„å®ä¾‹å¯¹è±¡ã€‚</p> <p>åˆ›å»ºä¸€ä¸ª <code>ColorFactoryBean</code> ç±»ï¼Œå®ç° <code>FactoryBean</code> æ¥å£ï¼Œç”¨äºç”Ÿäº§ <code>Color</code> å®ä¾‹å¯¹è±¡ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ColorFactoryBean</span> <span class="token keyword">implements</span> <span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Color</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">Color</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getObjectType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token class-name">Color</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªæ–°çš„é…ç½®ç±» <code>MainConfig2</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfig2</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">ColorFactoryBean</span> <span class="token function">colorFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ColorFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>æµ‹è¯•ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationOfFactoryBeanTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationOfFactoryBeanTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfig2</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> beanDefinitionNames <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBeanDefinitionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> beanDefinitionName <span class="token operator">:</span> beanDefinitionNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>beanDefinitionName<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
  
        <span class="token class-name">Object</span> bean <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;colorFactoryBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Object</span> bean2 <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;colorFactoryBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–åˆ°çš„beanå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–åˆ°çš„å®ä¾‹æ˜¯å¦åŒä¸€ä¸ªï¼Ÿ{}&quot;</span><span class="token punctuation">,</span> bean <span class="token operator">==</span> bean2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š  å¦‚æœè°ƒç”¨ <code>getBean()</code> æ–¹æ³•æ—¶æƒ³è·å–ä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦è®© <code>isSingleton()</code> æ–¹æ³•è¿”å› false å³å¯ã€‚<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120127235.png" loading="lazy" class="lazy"><br>
ä½¿ç”¨ <code>@Bean</code> æ³¨è§£å‘ Spring å®¹å™¨ä¸­æ³¨å†Œçš„æ˜¯ <code>ColorFactoryBean</code>ï¼Œè°ƒç”¨ getBean() æ–¹æ³•è·å–å‡ºæ¥çš„å´æ˜¯ <code>Color</code> å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘å°±æ˜¯æƒ³è·å– <code>ColorFactoryBean</code> ç±»å‹çš„å¯¹è±¡å®ä¾‹å‘¢ï¼Ÿå…¶å®ï¼Œä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€åœ¨è°ƒç”¨ <code>getBean()</code> æ–¹æ³•æ—¶ä¼ å…¥çš„ id å‰åŠ ä¸Š <code>&amp;</code> ç¬¦å·ï¼Œå¦‚ <code>&amp;colorFactoryBean</code>ï¼Œè·å–çš„å°±æ˜¯ <code>ColorFactoryBean</code> å¯¹è±¡å®ä¾‹ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationOfFactoryBeanTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationOfFactoryBeanTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfig2</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> beanDefinitionNames <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBeanDefinitionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> beanDefinitionName <span class="token operator">:</span> beanDefinitionNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>beanDefinitionName<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
  
        <span class="token class-name">Object</span> bean <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;colorFactoryBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Object</span> bean2 <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;colorFactoryBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–åˆ°çš„beanå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–åˆ°çš„å®ä¾‹æ˜¯å¦åŒä¸€ä¸ªï¼Ÿ{}&quot;</span><span class="token punctuation">,</span> bean <span class="token operator">==</span> bean2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
        <span class="token class-name">Object</span> bean3 <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;colorFactoryBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–åˆ°çš„beanå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> bean3<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128006.png" loading="lazy" class="lazy"></p> <h2 id="_3-ç”Ÿå‘½å‘¨æœŸ"><a href="#_3-ç”Ÿå‘½å‘¨æœŸ" class="header-anchor">#</a> 3. ç”Ÿå‘½å‘¨æœŸ</h2> <div class="language-ad-important line-numbers-mode"><pre class="language-text"><code>1. BeanNameAware çš„ setBeanName  
2. BeanClassLoaderAware çš„ setBeanClassLoader  
3. BeanFactoryAware çš„ setBeanFactory  
4. EnvironmentAware çš„ setEnvironment  
5. EmbeddedValueResolverAware çš„ setEmbeddedValueResolver  
6. ResourceLoaderAware çš„ setResourceLoader ï¼ˆä»…åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­è¿è¡Œæ—¶é€‚ç”¨ï¼‰  
7. ApplicationEventPublisherAware çš„ setApplicationEventPublisher ï¼ˆä»…åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­è¿è¡Œæ—¶é€‚ç”¨ï¼‰  
8. MessageSourceAware çš„ setMessageSource ï¼ˆä»…åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­è¿è¡Œæ—¶é€‚ç”¨ï¼‰  
9. ApplicationContextAware çš„ setApplicationContext ï¼ˆä»…åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­è¿è¡Œæ—¶é€‚ç”¨ï¼‰  
10. ServletContextAware çš„ setServletContext ï¼ˆä»…é€‚ç”¨äºåœ¨ Web åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­è¿è¡Œæ—¶ï¼‰  
11. **BeanPostProcessors** çš„ **postProcessBeforeInitialization** æ–¹æ³•  
12. **InitializingBean** çš„ **afterPropertiesSet**  
13. **è‡ªå®šä¹‰ init-method** å®šä¹‰  
14. **BeanPostProcessors** çš„ **postProcessAfterInitialization** æ–¹æ³•  

åœ¨å…³é—­ bean å·¥å‚æ—¶ï¼Œå°†åº”ç”¨ä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼š  

1. **DestructionAwareBeanPostProcessors** çš„ **postProcessBeforeDestruction** æ–¹æ³•  
2. **DisposableBean** çš„ **destroy**  
3. **è‡ªå®šä¹‰ destroy-method** å®šä¹‰
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_3-1-init-method-destroy-method"><a href="#_3-1-init-method-destroy-method" class="header-anchor">#</a> 3.1. init-method &amp; destroy-method</h3> <p>åœ¨ä½¿ç”¨ XML é…ç½®æ–‡ä»¶æ³¨å†Œ bean æ—¶ï¼Œå¯ä»¥é€šè¿‡ <code>bean</code> æ ‡ç­¾ä¸­çš„ <code>init-method</code> å’Œ <code>destory-method</code> å±æ€§åˆ†åˆ«æŒ‡å®š bean çš„åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š<br>
ä¿®æ”¹ <code>applicationContext.xml</code> é…ç½®æ–‡ä»¶æ³¨é‡Šæ‰åŒ…æ‰«æé…ç½®ï¼Œå»æ‰ <code>bean</code> æ ‡ç­¾ä¸­çš„ <code>scope=&quot;prototype&quot;</code> å±æ€§ã€‚</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans  
       http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token comment">&lt;!--    &lt;context:component-scan base-package=&quot;top.xiaorang.spring.annotation&quot;/&gt;--&gt;</span>  
  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>person<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation.bean.Person<span class="token punctuation">&quot;</span></span> <span class="token attr-name">init-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>init<span class="token punctuation">&quot;</span></span> <span class="token attr-name">destroy-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>destroy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xiaorang<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨ <code>Person</code> éœ€è¦å­˜åœ¨ <code>init()</code> ä¸ <code>destroy()</code> æ–¹æ³•ï¼Œè€Œä¸” Spring ä¸­è¿˜è§„å®š <code>init()</code> ä¸ <code>destroy()</code> æ–¹æ³•å¿…é¡»æ˜¯æ— å‚æ–¹æ³•ï¼Œä½†å¯ä»¥æŠ›å‡ºå¼‚å¸¸ã€‚<br>
ä¿®æ”¹ <code>SpringXmlConfigurationTest</code> æµ‹è¯•ç±»ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringXmlConfigurationTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringXmlConfigurationTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ClassPathXmlApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:applicationContext.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> beanDefinitionNames <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBeanDefinitionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> beanDefinitionName <span class="token operator">:</span> beanDefinitionNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>beanDefinitionName<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        applicationContext<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128314.png" loading="lazy" class="lazy"></p> <p>XML é…ç½®çš„æ–¹å¼å·²ç»äº†è§£ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æŒ‡å®š bean çš„åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•å‘¢ï¼Ÿåˆ«æ€¥ï¼Œå…ˆçœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>  
    <span class="token keyword">public</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;car... constructor...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;car... init...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;car... destroy...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªé…ç½®ç±» <code>MainConfigOfLifeCycle</code>ï¼ŒæŒ‡å®š <code>@Bean</code> æ³¨è§£ä¸­çš„ <code>initMethod</code> å’Œ <code>destroyMethod</code> å±æ€§åˆ†åˆ«å¯¹åº” <code>Car</code> ç±»ä¸­çš„ <code>init()</code> åˆå§‹åŒ–å’Œ <code>destroy()</code> é”€æ¯æ–¹æ³•ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfigOfLifeCycle</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>initMethod <span class="token operator">=</span> <span class="token string">&quot;init&quot;</span><span class="token punctuation">,</span> destroyMethod <span class="token operator">=</span> <span class="token string">&quot;destroy&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Car</span> <span class="token function">car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfLifeCycleTest</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationOfLifeCycleTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationOfLifeCycleTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">AnnotationConfigApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfigOfLifeCycle</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> beanDefinitionNames <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBeanDefinitionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> beanDefinitionName <span class="token operator">:</span> beanDefinitionNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>beanDefinitionName<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        applicationContext<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128335.png" loading="lazy" class="lazy"></p> <p>ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯å¯¹äºæ•°æ®æºçš„ç®¡ç†ã€‚å¦‚ï¼Œåœ¨é…ç½®æ•°æ®æºæ—¶ï¼Œåœ¨åˆå§‹åŒ–æ—¶ï¼Œå¯ä»¥å¯¹æ•°æ®æºçš„å±æ€§è¿›è¡Œèµ‹å€¼æ“ä½œï¼›åœ¨é”€æ¯çš„æ—¶å€™ï¼Œéœ€è¦å¯¹æ•°æ®æºçš„è¿æ¥ä¿¡æ¯è¿›è¡Œå…³é—­å’Œæ¸…ç†ã€‚æ­¤æ—¶ï¼Œå°±å¯ä»¥åœ¨è‡ªå®šä¹‰çš„åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ä¸­æ¥åšè¿™äº›äº‹æƒ…äº†ã€‚<br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¤šå®ä¾‹çš„ bean åœ¨å®¹å™¨å…³é—­çš„æ—¶å€™æ˜¯ä¸è¿›è¡Œé”€æ¯çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒSpring å®¹å™¨åˆ›å»ºå‡ºå¤šå®ä¾‹å¯¹è±¡åï¼Œè‡³äºä»€ä¹ˆæ—¶å€™é”€æ¯å°±æ˜¯è‡ªå·±çš„äº‹æƒ…ï¼ŒSpring ä¸å†ç®¡ç†è¿™äº›å¤šå®ä¾‹ bean å¯¹è±¡ã€‚</p> <h3 id="_3-2-initializingbean-disposablebean"><a href="#_3-2-initializingbean-disposablebean" class="header-anchor">#</a> 3.2. InitializingBean &amp; DisposableBean</h3> <p>Spring å®¹å™¨åœ¨ bean å®ä¾‹åŒ–ä»¥åŠå±æ€§èµ‹å€¼ä¹‹åå¯ä»¥æ‰§è¡Œ <code>InitializingBean</code> æ¥å£ä¸­çš„ <code>afterPropertiesSet()</code> æ–¹æ³•ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>
	<span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Spring å®¹å™¨åœ¨å…³é—­ä¹‹åä¼šæ‰§è¡Œ <code>DisposableBean</code> æ¥å£ä¸­çš„ <code>destroy()</code> æ–¹æ³•ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DisposableBean</span> <span class="token punctuation">{</span>
	<span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å¦‚æœä¸å»è¿½æºç çš„è¯ï¼Œå…¶å®ç†è§£èµ·æ¥è¿˜æ˜¯æŒºç®€å•çš„ï¼Œä¸è¿‡ä»¥åä¼šæœ‰æœºä¼šå»è¿½è¿½æºç ï¼Œç°åœ¨å…ˆå­¦ä¼šç”¨ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œå¼€å¹²ã€‚<br>
é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª <code>Cat</code> ç±»åŒæ—¶å®ç° <code>InitializingBean</code> å’Œ <code>DisposableBean</code> æ¥å£ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span><span class="token punctuation">,</span> <span class="token class-name">DisposableBean</span> <span class="token punctuation">{</span>  
    <span class="token keyword">public</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;cat constructor...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;cat afterPropertiesSet...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;cat destroy...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>ä¿®æ”¹é…ç½®ç±» <code>MainConfigOfLifeCycle</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfigOfLifeCycle</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>initMethod <span class="token operator">=</span> <span class="token string">&quot;init&quot;</span><span class="token punctuation">,</span> destroyMethod <span class="token operator">=</span> <span class="token string">&quot;destroy&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Car</span> <span class="token function">car</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Cat</span> <span class="token function">cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è¿è¡Œ <code>SpringAnnotationConfigurationOfLifeCycleTest</code> æµ‹è¯•ç±»ä¸­çš„æµ‹è¯•æ–¹æ³• <code>test()</code>ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128337.png" loading="lazy" class="lazy"></p> <h2 id="_4-å±æ€§èµ‹å€¼"><a href="#_4-å±æ€§èµ‹å€¼" class="header-anchor">#</a> 4. å±æ€§èµ‹å€¼</h2> <p>åœ¨ä½¿ç”¨ XML é…ç½®æ–‡ä»¶æ³¨å†Œ bean æ—¶ï¼Œå¯ä»¥é€šè¿‡ <code>bean</code> æ ‡ç­¾ä¸­åµŒå¥— <code>property</code> æ ‡ç­¾ç»™ bean ä¸­çš„å±æ€§èµ‹å€¼ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans  
       http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token comment">&lt;!--    &lt;context:component-scan base-package=&quot;top.xiaorang.spring.annotation&quot;/&gt;--&gt;</span>  
  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>person<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation.bean.Person<span class="token punctuation">&quot;</span></span> <span class="token attr-name">init-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>init<span class="token punctuation">&quot;</span></span> <span class="token attr-name">destroy-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>destroy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xiaorang<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>property</code> æ ‡ç­¾ä¸­çš„ <code>name</code> å±æ€§ä¸º bean ä¸­å­—æ®µçš„åç§°ï¼Œ<code>value</code> å±æ€§ä¸ºè¦èµ‹ç»™ bean ä¸­å¯¹åº”å­—æ®µçš„å€¼ã€‚<br>
XML é…ç½®çš„æ–¹å¼å·²ç»äº†è§£ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨æ³¨è§£çš„æ–¹å¼ç»™ bean ä¸­çš„å±æ€§èµ‹å€¼å‘¢ï¼Ÿæ­¤æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ° Spring ä¸­çš„ <code>@Value</code> æ³¨è§£ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">FIELD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">PARAMETER</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION_TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Value</span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * The actual value expression such as &lt;code&gt;#{systemProperties.myProp}&lt;/code&gt;
	 * or property placeholder such as &lt;code&gt;${my.app.myProp}&lt;/code&gt;.
	 */</span>
	<span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>ä» <code>@Value</code> æ³¨è§£æºç å¯ä»¥çœ‹å‡ºï¼Œ<code>@Value</code> æ³¨è§£å¯ä»¥æ ‡æ³¨åœ¨å­—æ®µã€æ–¹æ³•ã€å‚æ•°ä»¥åŠæ³¨è§£ä¸Šï¼Œå¹¶ä¸”åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç”Ÿæ•ˆã€‚  <code>@Value</code> æ³¨è§£çš„ä¸»è¦ä½œç”¨æ˜¯ <strong>å®Œæˆå±æ€§çš„èµ‹å€¼</strong>ã€‚<br>
æ”¯æŒ åŸºæœ¬ç±»å‹å’Œ String ç±»å‹çš„æ•°æ®ï¼ŒSpring çš„ EL è¡¨è¾¾å¼ï¼Œé€šè¿‡ <code>${}</code> çš„æ–¹å¼è·å–é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œé…ç½®æ–‡ä»¶æ”¯æŒ propertiesï¼Œxml å’Œ yml æ–‡ä»¶ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Teacher</span> <span class="token punctuation">{</span>  
    <span class="token comment">/**  
     * Stringç±»å‹  
     */</span>  
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;å°è®©&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>  
    <span class="token comment">/**  
     * SPELè¡¨è¾¾å¼  
     */</span>  
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;#{30-3}&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
      
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;#{T(Math).random()}&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">private</span> <span class="token keyword">double</span> salary<span class="token punctuation">;</span>  
    <span class="token comment">/**  
	 * ä»ç¯å¢ƒå˜é‡ä¸­å–å€¼  
	 */</span>  
	<span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${teacher.workDate}&quot;</span><span class="token punctuation">)</span>  
	<span class="token keyword">private</span> <span class="token class-name">String</span> workDate<span class="token punctuation">;</span>  
	<span class="token comment">/**  
	 * ä»ç¯å¢ƒå˜é‡ä¸­å–å€¼ï¼Œå¦‚æœæ²¡æœ‰è¯¥é…ç½®ï¼Œåˆ™ç»™ä¸€ä¸ªé»˜è®¤å€¼  
	 */</span> 
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${teacher.teach:english}&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> teach<span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;Teacher{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;name='&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>  
                <span class="token string">&quot;, age=&quot;</span> <span class="token operator">+</span> age <span class="token operator">+</span>  
                <span class="token string">&quot;, salary=&quot;</span> <span class="token operator">+</span> salary <span class="token operator">+</span>  
                <span class="token string">&quot;, workDate='&quot;</span> <span class="token operator">+</span> workDate <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>  
                <span class="token string">&quot;, teach='&quot;</span> <span class="token operator">+</span> teach <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªé…ç½®ç±» <code>MainConfigOfPropertyValue</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfigOfPropertyValue</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Teacher</span> <span class="token function">teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfPropertyValueTest</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationOfPropertyValueTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationOfPropertyValueTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">AnnotationConfigApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfigOfPropertyValue</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Teacher</span> teacher <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">Teacher</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\nè·å–åˆ°çš„teacherå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> teacher<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128952.png" loading="lazy" class="lazy"><br>
ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½å·²ç»å‘ç°ï¼Œ<code>teacher</code> å®ä¾‹å¯¹è±¡ä¸­çš„ <code>workDate</code> å±æ€§å€¼å¥½åƒæœ‰ç‚¹ä¸å¯¹å•Šï¼è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼ŸåŸå› æ˜¯ç¯å¢ƒå˜é‡ä¸­å¹¶æ²¡æœ‰è¯¥é…ç½®ï¼Œæ‰€ä»¥ç›´æ¥å°†è¡¨è¾¾å¼åŸæ ·è¾“å‡ºï¼Œå¹¶æ²¡æœ‰åƒç½‘ä¸Šè¯´çš„é‚£æ ·ç›´æ¥æŠ¥é”™ï¼ˆå¯èƒ½æ˜¯ç‰ˆæœ¬ä¸åŒå§ï¼‰ã€‚é‚£ä¹ˆè¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ<br>
ç°åœ¨éœ€è¦ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ³¨è§£ <code>@ProperySource</code>ï¼Œè¯¥æ³¨è§£ç­‰ä»·äº XML é…ç½®æ–‡ä»¶ä¸­çš„ <code>&lt;context:property-placeholder location=&quot;classpath:xxx.properties&quot;/&gt;</code> æ ‡ç­¾ï¼Œç”¨äºå°†é…ç½®æ–‡ä»¶ä¸­çš„ key=value å­˜å‚¨åˆ° Spring çš„ç¯å¢ƒå˜é‡ <code>Environment</code> ä¸­ï¼Œç„¶å <code>Environment</code> æ¥å£æä¾›äº†æ–¹æ³•å»è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„å€¼ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ <code>@Value</code> æ³¨è§£ä»¥ <code>${}</code> çš„æ–¹å¼è·å–é…ç½®æ–‡ä»¶ä¸­å¯¹åº” key çš„ value å€¼æ³¨å…¥åˆ° bean çš„å±æ€§ä¸­ã€‚<br>
åœ¨èµ„æºç›®å½•ä¸‹å¢åŠ ä¸€ä¸ª <code>teacher.properties</code> é…ç½®æ–‡ä»¶ï¼š</p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">teacher.workDate</span><span class="token punctuation">=</span><span class="token value attr-value">2022-08-29  </span>
<span class="token key attr-name">teacher.teach</span><span class="token punctuation">=</span><span class="token value attr-value">math</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ç°åœ¨ä¿®æ”¹é…ç½®ç±» <code>MainConfigOfPropertyValue</code>ï¼šå¢åŠ  <code>@ProperySource</code> æ³¨è§£ï¼Œå…¶ <code>value</code> å±æ€§å€¼ä¸ºé…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@PropertySource</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;classpath:teacher.properties&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfigOfPropertyValue</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Teacher</span> <span class="token function">teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å†æ¬¡æ‰§è¡Œæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfPropertyValueTest</code> ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128843.png" loading="lazy" class="lazy"></p> <p>ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong><code>#{}</code> ä¸»è¦ç”¨äºæ‰§è¡Œ SPEL è¡¨è¾¾å¼</strong>ï¼Œ<strong><code>${}</code> ä¸»è¦ç”¨äºè·å–é…ç½®æ–‡ä»¶çš„å€¼</strong>ã€‚</p> <h2 id="_5-è‡ªåŠ¨è£…é…"><a href="#_5-è‡ªåŠ¨è£…é…" class="header-anchor">#</a> 5. è‡ªåŠ¨è£…é…</h2> <h3 id="_5-1-autowired-æ³¨è§£"><a href="#_5-1-autowired-æ³¨è§£" class="header-anchor">#</a> 5.1. @Autowired æ³¨è§£</h3> <p>åœ¨ XML é…ç½®æ–‡ä»¶ä¸­ç»™ä¸€ä¸ª bean ä¸­çš„å±æ€§æ³¨å…¥å¦ä¸€ä¸ª bean æ—¶ï¼Œéœ€è¦ç”¨åˆ° <code>property</code> æ ‡ç­¾ä¸­çš„ <code>ref</code> å±æ€§ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/context<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>  
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans  
       http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
    <span class="token comment">&lt;!--    &lt;context:component-scan base-package=&quot;top.xiaorang.spring.annotation&quot;/&gt;--&gt;</span>  
  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>person<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation.bean.Person<span class="token punctuation">&quot;</span></span> <span class="token attr-name">init-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>init<span class="token punctuation">&quot;</span></span> <span class="token attr-name">destroy-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>destroy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xiaorang<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>  
  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath:teacher.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bookRepository<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation.repository.BookRepository<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bookService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation.service.BookService<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bookRepository<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bookRepository<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bookController<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top.xiaorang.spring.annotation.controller.BookController<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>  
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bookService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bookService<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>ä¿®æ”¹ <code>BookController</code> ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookController</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token class-name">BookService</span> bookService<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">BookService</span> <span class="token function">getBookService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> bookService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBookService</span><span class="token punctuation">(</span><span class="token class-name">BookService</span> bookService<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>bookService <span class="token operator">=</span> bookService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;BookController{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;bookService=&quot;</span> <span class="token operator">+</span> bookService <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>ä¿®æ”¹ <code>BookService</code> ç±»ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookService</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token class-name">BookRepository</span> bookRepository<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">BookRepository</span> <span class="token function">getBookRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> bookRepository<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBookRepository</span><span class="token punctuation">(</span><span class="token class-name">BookRepository</span> bookRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>bookRepository <span class="token operator">=</span> bookRepository<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;BookService{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;bookRepository=&quot;</span> <span class="token operator">+</span> bookRepository <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>ä¿®æ”¹æµ‹è¯•ç±» <code>SpringXmlConfigurationTest</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringXmlConfigurationTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringXmlConfigurationTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ClassPathXmlApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:applicationContext.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">BookController</span> bookController <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">BookController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\nè·å–åˆ°çš„beanå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> bookController<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128545.png" loading="lazy" class="lazy"><br>
è™½ç„¶é€šè¿‡ XML çš„æ–¹å¼å¯ä»¥å®ç°å°†ä¸€ä¸ª bean æ³¨å…¥ç»™å¦å¤–ä¸€ä¸ª bean ä¸­çš„å±æ€§ä¸­ï¼Œä½†æ˜¯è¿™æ ·éå¸¸ç¹çï¼Œæœ‰æ²¡æœ‰æ›´åŠ ç®€ä¾¿çš„æ–¹å¼å‘¢ï¼Ÿé‚£å°±ä¸å¾—ä¸æåˆ°ä»Šå¤©çš„ä¸»è§’ <code>@Autowired</code> æ³¨è§£ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">CONSTRUCTOR</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">PARAMETER</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">FIELD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">ANNOTATION_TYPE</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Autowired</span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * Declares whether the annotated dependency is required.
	 * &lt;p&gt;Defaults to {@code true}.
	 */</span>
	<span class="token keyword">boolean</span> <span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>ä»æºç ä¸­å¯ä»¥çœ‹å‡ºï¼Œ<code>@Autowired</code> æ³¨è§£å¯ä»¥æ ‡æ³¨åœ¨æ„é€ æ–¹æ³•ã€æ–¹æ³•ã€å‚æ•°ã€å­—æ®µä»¥åŠæ³¨è§£ä¸Šã€‚é‚£ä¹ˆå¦‚ä½•é€šè¿‡ <code>@Autowired</code> æ³¨è§£å®ç° XML é…ç½®æ–‡ä»¶æ–¹å¼ç›¸åŒçš„æ•ˆæœå‘¢ï¼Ÿ<br>
ç»™ <code>BookController</code> ç±»ä¸­çš„ <code>bookService</code> å±æ€§ä¸Šæ ‡æ³¨ <code>@Autowired</code> æ³¨è§£ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookController</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Autowired</span>  
    <span class="token keyword">private</span> <span class="token class-name">BookService</span> bookService<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">BookService</span> <span class="token function">getBookService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> bookService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBookService</span><span class="token punctuation">(</span><span class="token class-name">BookService</span> bookService<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>bookService <span class="token operator">=</span> bookService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;BookController{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;bookService=&quot;</span> <span class="token operator">+</span> bookService <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>ç»™ <code>BookService</code> ç±»ä¸­çš„ <code>bookRepository</code> å±æ€§ä¸Šæ ‡æ³¨ <code>@Autowired</code> æ³¨è§£ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookService</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Autowired</span>  
    <span class="token keyword">private</span> <span class="token class-name">BookRepository</span> bookRepository<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">BookRepository</span> <span class="token function">getBookRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> bookRepository<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBookRepository</span><span class="token punctuation">(</span><span class="token class-name">BookRepository</span> bookRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>bookRepository <span class="token operator">=</span> bookRepository<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;BookService{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;bookRepository=&quot;</span> <span class="token operator">+</span> bookRepository <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªæ–°çš„é…ç½®ç±»ï¼šæ‰«æ <code>repository</code>ã€<code>service</code> å’Œ <code>controller</code> åŒ…ï¼Œå°† <code>BookController</code>ã€<code>BookService</code> å’Œ <code>BookRepository</code> ä¸‰ä¸ªç»„ä»¶æ³¨å†Œåˆ° Spring å®¹å™¨å½“ä¸­ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;top.xiaorang.spring.annotation.repository&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;top.xiaorang.spring.annotation.service&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;top.xiaorang.spring.annotation.controller&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfigOfAutowired</span> <span class="token punctuation">{</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>åˆ›å»ºæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfAutowiredTest</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationOfAutowiredTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationOfAutowiredTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfigOfAutowired</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">BookController</span> bookController <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">BookController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\nè·å–åˆ°çš„beanå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> bookController<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128792.png" loading="lazy" class="lazy"><br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<strong><code>@Autowired</code> æ³¨è§£é»˜è®¤æ˜¯æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…çš„</strong>ã€‚é‚£ä¹ˆå­˜åœ¨å¤šä¸ªç±»å‹ç›¸åŒçš„ç»„ä»¶æ—¶è¯¥å¦‚ä½•è¿›è¡Œè£…é…å‘¢ï¼Ÿ<br>
å®šä¹‰ä¸€ä¸ª <code>OrderService</code> æ¥å£ï¼Œå­˜åœ¨ä¸¤ä¸ªå®ç°ç±» <code>OrderServiceImpl</code> å’Œ <code>OrderServiceImpl2</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> label <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderServiceImpl{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;label='&quot;</span> <span class="token operator">+</span> label <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl2</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> label <span class="token operator">=</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderServiceImpl{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;label='&quot;</span> <span class="token operator">+</span> label <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>åˆ›å»º <code>OrderController</code> ç±»ï¼Œéœ€è¦æ³¨å…¥ä¸€ä¸ª <code>OrderService</code> ç±»å‹çš„ beanï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Autowired</span>  
    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderService<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">OrderService</span> <span class="token function">getOrderService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> orderService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOrderService</span><span class="token punctuation">(</span><span class="token class-name">OrderService</span> orderService<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>orderService <span class="token operator">=</span> orderService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>è¿è¡Œæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfAutowiredTest</code> ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128573.png" loading="lazy" class="lazy"><br>
å‘ç°æŠ¥é”™ï¼Œæ„æ€æ˜¯éœ€è¦æ³¨å…¥å”¯ä¸€çš„ä¸€ä¸ª beanï¼Œä½†æ˜¯å´å‘ç° 2 ä¸ªåŒ¹é…çš„ï¼Œæ­¤æ—¶æ€ä¹ˆåŠå‘¢ï¼Ÿ<strong><code>@Autowired</code> æ³¨è§£é»˜è®¤æ˜¯æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…çš„ï¼Œå½“æ‰¾åˆ°å¤šä¸ªç›¸åŒç±»å‹çš„ç»„ä»¶æ—¶ï¼Œå°†ç»§ç»­æŒ‰ç…§å±æ€§åç§°å»åŒ¹é…</strong>ã€‚</p> <h4 id="_5-1-1-ä¿®æ”¹å±æ€§å"><a href="#_5-1-1-ä¿®æ”¹å±æ€§å" class="header-anchor">#</a> 5.1.1. ä¿®æ”¹å±æ€§å</h4> <p>ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯ä¿®æ”¹å±æ€§åï¼Œä½¿å…¶ä¸å…¶ä¸­ä¸€ä¸ªç»„ä»¶çš„åç§°ç›¸åŒã€‚å°† <code>orderService</code> å±æ€§åæ”¹æˆ <code>orderServiceImpl</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Autowired</span>  
    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderServiceImpl<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">OrderService</span> <span class="token function">getOrderServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> orderServiceImpl<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOrderServiceImpl</span><span class="token punctuation">(</span><span class="token class-name">OrderService</span> orderServiceImpl<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>orderServiceImpl <span class="token operator">=</span> orderServiceImpl<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderController{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;orderService=&quot;</span> <span class="token operator">+</span> orderServiceImpl <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>ä¿®æ”¹æµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfAutowiredTest</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationOfAutowiredTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationOfAutowiredTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfigOfAutowired</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">BookController</span> bookController <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">BookController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\nè·å–åˆ°çš„beanå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> bookController<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">OrderController</span> orderController <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">OrderController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;\nè·å–åˆ°çš„beanå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> orderController<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128037.png" loading="lazy" class="lazy"></p> <h4 id="_5-1-2-qualifier-æ³¨è§£"><a href="#_5-1-2-qualifier-æ³¨è§£" class="header-anchor">#</a> 5.1.2. @Qualifier æ³¨è§£</h4> <p>é€šå¸¸æƒ…å†µä¸‹ï¼Œ<code>@Qualifier</code> æ³¨è§£å¿…é¡»æ­é… <code>@Autowired</code> æ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼ŒåŒæ ·èƒ½è§£å†³ <code>@Autowired</code> æ³¨è§£åŒ¹é…åˆ°å¤šä¸ªç±»å‹ç›¸åŒçš„ç»„ä»¶æ—¶è€ŒæŠ¥é”™çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ <code>Qualifier</code> æ³¨è§£æ˜ç¡®éœ€è¦è£…é…å“ªä¸ªç»„ä»¶ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;orderServiceImpl2&quot;</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Autowired</span>  
    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderServiceImpl<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">OrderService</span> <span class="token function">getOrderServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> orderServiceImpl<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOrderServiceImpl</span><span class="token punctuation">(</span><span class="token class-name">OrderService</span> orderServiceImpl<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>orderServiceImpl <span class="token operator">=</span> orderServiceImpl<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderController{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;orderService=&quot;</span> <span class="token operator">+</span> orderServiceImpl <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>è¿è¡Œæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfAutowiredTest</code> ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128659.png" loading="lazy" class="lazy"><br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå½“å±æ€§åä¸ <code>@Qualifier</code> æ³¨è§£ä¸€èµ·ä½œç”¨æ—¶ï¼Œä»¥ <code>@Qualifier</code> æ³¨è§£ä¸ºä¸»ï¼Œå¦‚æœæ‰¾ä¸åˆ° <code>@Qualifier</code> æ³¨è§£æ ‡æ³¨çš„ç»„ä»¶ï¼Œåˆ™ç›´æ¥æŠ¥é”™ã€‚</p> <h4 id="_5-1-3-primary-æ³¨è§£"><a href="#_5-1-3-primary-æ³¨è§£" class="header-anchor">#</a> 5.1.3. @Primary æ³¨è§£</h4> <p>å½“åœ¨æŸä¸ªæ¥å£çš„å®ç°ç±»ç»„ä»¶ä¸Šæ ‡æ³¨ <code>@Primary</code> æ³¨è§£æ—¶ï¼Œå¦‚æœè¯¥æ¥å£å­˜åœ¨å¤šä¸ªå®ç°ç±»ç»„ä»¶ï¼Œåˆ™ä¼šä¼˜å…ˆæ³¨å…¥æ ‡æ³¨äº† <code>@Primary</code> æ³¨è§£çš„å®ç°ç±»ç»„ä»¶ã€‚<br>
ä¿®æ”¹ <code>OrderController</code>ï¼Œå»æ‰ <code>orderService</code> å±æ€§ä¸Šæ ‡æ³¨çš„ <code>@Qualifier</code> æ³¨è§£ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Autowired</span>  
    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderServiceImpl<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">OrderService</span> <span class="token function">getOrderServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> orderServiceImpl<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOrderServiceImpl</span><span class="token punctuation">(</span><span class="token class-name">OrderService</span> orderServiceImpl<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>orderServiceImpl <span class="token operator">=</span> orderServiceImpl<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderController{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;orderService=&quot;</span> <span class="token operator">+</span> orderServiceImpl <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>åœ¨ <code>OrderServiceImpl</code> ç±»æ ‡æ³¨ <code>@Primary</code> æ³¨è§£ï¼Œè¡¨ç¤ºä¼˜å…ˆæ³¨å…¥è¯¥ç»„ä»¶ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Primary</span>  
<span class="token annotation punctuation">@Service</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl2</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> label <span class="token operator">=</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderServiceImpl{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;label='&quot;</span> <span class="token operator">+</span> label <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è¿è¡Œæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfAutowiredTest</code> ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120128544.png" loading="lazy" class="lazy"><br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå½“å±æ€§åä¸ <code>@Primary</code> æ³¨è§£ä¸€èµ·ä½œç”¨æ—¶ï¼Œä»¥ <code>@Primary</code> æ³¨è§£ä¸ºä¸»ï¼›å½“ <code>@Primary</code> ä¸ <code>@Qualifier</code> æ³¨è§£ä¸€èµ·ä½œç”¨æ—¶ï¼Œä»¥ <code>@Qualifier</code> æ³¨è§£ä¸ºä¸»ï¼›å¦‚æœæ‰¾ä¸åˆ° <code>@Qualifier</code> æ³¨è§£æ ‡æ³¨çš„ç»„ä»¶ï¼Œåˆ™ç›´æ¥æŠ¥é”™ã€‚<br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>@Autowired</code> æ³¨è§£é»˜è®¤æ˜¯å¿…é¡»æ‰¾åˆ°æŸä¸ª bean è¿›è€Œå®Œæˆæ³¨å…¥ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å¦‚æœæƒ³è¦æ‰¾ä¸åˆ°ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œåªéœ€è¦å°† <code>@Autowired</code> æ³¨è§£çš„ <code>required</code> å±æ€§ç½®ä¸º false å³å¯ã€‚</p> <div class="language-ad-info line-numbers-mode"><pre class="language-text"><code>`@Autowried`Â æ³¨è§£å¯ä»¥æ ‡æ³¨åœ¨ç±»ï¼Œæ–¹æ³•ï¼Œå±æ€§ï¼Œå‚æ•°ä½ç½®ä¸Šï¼Œä½†æ˜¯**é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œ**å»ºè®®æˆ‘ä»¬**æ ‡æ³¨åœ¨æ„é€ å™¨ä¸Š**ï¼Œ**å¦‚æœæ ‡æ³¨åœ¨æ„é€ å™¨ä¸Šï¼Œé‚£ä¹ˆæ„é€ å™¨ä¸­çš„å‚æ•°å¿…é¡»æ˜¯IOCå®¹å™¨ä¸­çš„beanå®ä¾‹**ï¼Œè€Œä¸”**å¦‚æœåªæœ‰ä¸€ä¸ªæœ‰å‚æ„é€ å™¨ï¼Œé‚£ä¹ˆæ„é€ å™¨ä¸Šçš„ @Autowired æ³¨è§£å¯ä»¥çœç•¥**
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_5-2-resourece-æ³¨è§£"><a href="#_5-2-resourece-æ³¨è§£" class="header-anchor">#</a> 5.2. @Resourece æ³¨è§£</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token constant">TYPE</span><span class="token punctuation">,</span> <span class="token constant">FIELD</span><span class="token punctuation">,</span> <span class="token constant">METHOD</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Resource</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">lookup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token keyword">enum</span> <span class="token class-name">AuthenticationType</span> <span class="token punctuation">{</span>
            <span class="token constant">CONTAINER</span><span class="token punctuation">,</span>
            <span class="token constant">APPLICATION</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">AuthenticationType</span> <span class="token function">authenticationType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token class-name">AuthenticationType</span><span class="token punctuation">.</span><span class="token constant">CONTAINER</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> <span class="token function">shareable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">mappedName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><code>@Resourece</code> æ³¨è§£æ˜¯ <code>JSR250</code> è§„èŒƒé‡Œå®šä¹‰çš„ä¸€ä¸ªæ³¨è§£ï¼Œæ³¨è§£ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§ <code>name</code> å’Œ <code>type</code>ã€‚</p> <ul><li>å¦‚æœæŒ‡å®šäº† <code>name</code> å±æ€§ å’Œ <code>type</code> å±æ€§ï¼Œåˆ™ä» Spring å®¹å™¨ä¸­æ‰¾ä¸€ä¸ªåç§°ä¸ <code>name</code> å±æ€§å’Œç±»å‹ä¸ <code>type</code> å±æ€§éƒ½ç›¸åŒçš„ç»„ä»¶ï¼Œæ‰¾ä¸åˆ°åˆ™æŠ¥é”™ã€‚</li> <li>å¦‚æœåªæŒ‡å®šäº† <code>name</code> å±æ€§ï¼Œåˆ™ä» Spring å®¹å™¨ä¸­æ‰¾ä¸€ä¸ªåç§°ä¸ <code>name</code> å±æ€§ç›¸åŒçš„ç»„ä»¶ï¼Œæ‰¾ä¸åˆ°åˆ™æŠ¥é”™ã€‚</li> <li>å¦‚æœåªæŒ‡å®šäº† <code>type</code> å±æ€§ï¼Œåˆ™ä» Spring å®¹å™¨ä¸­æ‰¾ä¸€ä¸ªç±»å‹ä¸ä¸ <code>type</code> å±æ€§ç›¸åŒçš„ç»„ä»¶ï¼Œæ‰¾ä¸åˆ°æˆ–è€…æ‰¾åˆ°å¤šä¸ªç±»å‹ç›¸åŒçš„ç»„ä»¶åˆ™æŠ¥é”™ã€‚</li> <li>å¦‚æœä¸¤ä¸ªå±æ€§éƒ½æ²¡æœ‰æŒ‡å®šï¼Œåˆ™ <strong>é»˜è®¤æŒ‰ç…§åç§°è¿›è¡Œè£…é…è¿›è¡Œè£…é…</strong>ï¼ŒæŒ‰åç§°æ‰¾ä¸åˆ°åˆ™æŒ‰ç±»å‹è¿›è¡Œè£…é…ï¼Œå¦‚æœæ‰¾åˆ°å¤šä¸ªç±»å‹ç›¸åŒçš„ç»„ä»¶åˆ™åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»„ä»¶æ ‡æ³¨ <code>@Primary</code> æ³¨è§£ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æŠ¥æ‰¾åˆ°å¤šä¸ªç»„ä»¶çš„å¼‚å¸¸ï¼›å¦‚æœæŒ‰ç±»å‹è¿˜æ˜¯æ‰¾ä¸åˆ°åˆ™æŠ¥é”™ã€‚</li></ul> <p>ä¿®æ”¹åŸæœ‰çš„ <code>OrderController</code> ç±»è¿›è¡Œæµ‹è¯•ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Resource</span>  
    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderService<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">OrderService</span> <span class="token function">getOrderService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> orderService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOrderService</span><span class="token punctuation">(</span><span class="token class-name">OrderService</span> orderService<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>orderService <span class="token operator">=</span> orderService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderController{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;orderService=&quot;</span> <span class="token operator">+</span> orderService <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>ä¿®æ”¹ <code>OrderServiceImpl2</code> ç±»ï¼Œå»æ‰ <code>@Primary</code> æ³¨è§£ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl2</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token class-name">String</span> label <span class="token operator">=</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderServiceImpl{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;label='&quot;</span> <span class="token operator">+</span> label <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>è¿è¡Œæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfAutowiredTest</code> ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120129496.png" loading="lazy" class="lazy"><br>
æŠ¥é”™ä¿¡æ¯ <code>No qualifying bean of type 'top.xiaorang.spring.annotation.service.OrderService' available: expected single matching bean but found 2: orderServiceImpl,orderServiceImpl2</code>ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯æ‰¾åˆ°ä¸¤ä¸ªç±»å‹ç›¸åŒçš„ç»„ä»¶ã€‚å¦‚ä½•è§£å†³å‘¢ï¼Ÿâ‘ åœ¨ <code>@Autowired</code> æ³¨è§£ä¸­çš„è§£å†³æ–¹æ¡ˆåœ¨è¿™é‡Œéƒ½é€‚ç”¨ï¼Œå¦‚ä¿®æ”¹å±æ€§åï¼Œæ­é… <code>@Qualifier</code> æ³¨è§£æˆ–è€… <code>@Primary</code> æ³¨è§£ã€‚â‘¡æˆ–è€…æŒ‡å®š <code>@Reaource</code> æ ‡ç­¾ä¸­çš„ <code>name</code> å±æ€§å’Œ <code>type</code> å±æ€§ã€‚<br>
ç°åœ¨è¯•ä¸‹æŒ‡å®š <code>@Resource</code> æ³¨è§£çš„ <code>name</code> å±æ€§ä¸º <code>orderServiceImpl2</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;orderServiceImpl2&quot;</span><span class="token punctuation">)</span>  
    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderService<span class="token punctuation">;</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">OrderService</span> <span class="token function">getOrderService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> orderService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOrderService</span><span class="token punctuation">(</span><span class="token class-name">OrderService</span> orderService<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span>orderService <span class="token operator">=</span> orderService<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Override</span>  
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token string">&quot;OrderController{&quot;</span> <span class="token operator">+</span>  
                <span class="token string">&quot;orderService=&quot;</span> <span class="token operator">+</span> orderService <span class="token operator">+</span>  
                <span class="token char">'}'</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>è¿è¡Œæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfAutowiredTest</code> ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120129052.png" loading="lazy" class="lazy"></p> <h3 id="_5-3-profile-æ³¨è§£"><a href="#_5-3-profile-æ³¨è§£" class="header-anchor">#</a> 5.3. @Profile æ³¨è§£</h3> <h4 id="_5-3-1-å†™åœ¨å‰é¢"><a href="#_5-3-1-å†™åœ¨å‰é¢" class="header-anchor">#</a> 5.3.1. å†™åœ¨å‰é¢</h4> <p>åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œå¾€å¾€ä¼šå°†é¡¹ç›®ç¯å¢ƒåˆ†ä¸ºå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒç­‰ç­‰ã€‚åœ¨ä»¥å‰çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶çš„å½¢å¼ï¼Œå°†é¡¹ç›®çš„é…ç½®ä¿®æ”¹æˆæµ‹è¯•ç¯å¢ƒï¼Œç„¶åæ‰å‘å¸ƒåˆ°æµ‹è¯•ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ï¼Œæµ‹è¯•é€šè¿‡åï¼Œå†å°†é¡¹ç›®çš„é…ç½®ä¿®æ”¹æˆç”Ÿæˆç¯å¢ƒï¼Œç„¶åæ­£å¼å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚è¿™æ ·æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œä¸ä»…å¢åŠ äº†å¼€å‘å’Œè¿ç»´çš„å·¥ä½œé‡ï¼Œè€Œä¸”æ€»æ˜¯æ‰‹åŠ¨ä¿®æ”¹å„é¡¹é…ç½®æ–‡ä»¶å¾ˆå®¹æ˜“å‡ºé—®é¢˜ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ç§åƒåŠ›ä¸è®¨å¥½çš„æ–¹å¼å‘¢ï¼Ÿæœ‰ï¼Œä½¿ç”¨ <code>@Profile</code> æ³¨è§£å³å¯ã€‚</p> <h4 id="_5-3-2-æ¦‚è¿°"><a href="#_5-3-2-æ¦‚è¿°" class="header-anchor">#</a> 5.3.2. æ¦‚è¿°</h4> <p><code>@Profile</code> æ³¨è§£æ˜¯ Spring æä¾›çš„å¯ä»¥æ ¹æ®å½“å‰ç¯å¢ƒåŠ¨æ€æ¿€æ´»å’Œåˆ‡æ¢ä¸€ç³»åˆ—ç»„ä»¶çš„åŠŸèƒ½ã€‚è¿™ä¸ªåŠŸèƒ½ä¸»è¦é’ˆå¯¹åœ¨ä¸åŒçš„ç¯å¢ƒä½¿ç”¨ä¸åŒçš„å˜é‡ï¼Œå¦‚ï¼Œåœ¨å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒä¸‹éœ€è¦ä½¿ç”¨ä¸åŒçš„æ•°æ®æºï¼Œåœ¨ä¸æ”¹å˜ä»£ç çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ³¨è§£æ¥åŠ¨æ€åœ°åˆ‡æ¢è¦è¿æ¥åœ°æ•°æ®åº“ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Conditional</span><span class="token punctuation">(</span><span class="token class-name">ProfileCondition</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Profile</span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * The set of profiles for which the annotated component should be registered.
	 */</span>
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>ä»æºç å¯ä»¥çœ‹å‡ºï¼Œ<code>@Profile</code> æ³¨è§£å¯ä»¥æ ‡æ³¨åœ¨ç±»å’Œæ–¹æ³•ä¸Šã€‚<br>
ğŸ’¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå½“ <code>@Profile</code> æ³¨è§£æ ‡æ³¨åœ¨é…ç½®ç±»ä¸Šæ—¶ï¼Œåªæœ‰åœ¨æŒ‡å®šçš„ç¯å¢ƒä¸‹ï¼Œæ•´ä¸ªé…ç½®ç±»ä¸­çš„æ‰€æœ‰é…ç½®æ‰ä¼šç”Ÿæ•ˆï¼›å½“ bean ä¸Šæ ‡æ³¨ <code>@Profile</code> æ³¨è§£ï¼Œä¹Ÿåªæœ‰åœ¨æŒ‡å®šç¯å¢ƒä¸‹æ‰ä¼šè¢«æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ï¼Œå¦‚æœæ²¡æœ‰æ ‡æ³¨ <code>@Profile</code> æ³¨è§£çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ª bean åœ¨ä»»ä½•ç¯å¢ƒä¸‹éƒ½ä¼šè¢«æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ï¼Œå‰ææ˜¯é…ç½®ç±»ç¬¦åˆæ¡ä»¶ã€‚</p> <h4 id="_5-3-3-æ¡ˆä¾‹"><a href="#_5-3-3-æ¡ˆä¾‹" class="header-anchor">#</a> 5.3.3. æ¡ˆä¾‹</h4> <p>ä»¥ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥æ¼”ç¤ºä¸€ä¸‹ï¼Œå‡å¦‚æœ‰ä¸‰ä¸ªäººï¼Œåˆ†åˆ«æ˜¯å¼ ä¸‰ã€æå››ã€ç‹äº”ï¼Œåœ¨ dev ç¯å¢ƒä¸‹å­˜åœ¨å¼ ä¸‰ï¼Œåœ¨ test ç¯å¢ƒä¸‹å­˜åœ¨æå››ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹å­˜åœ¨ç‹äº”ï¼ŒæŒ‡å®šå“ªä¸ªç¯å¢ƒï¼Œè°å°±è¢«æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚<br>
åˆ›å»ºä¸€ä¸ªæ–°çš„é…ç½®ç±» <code>MainConfigOfProfile</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfigOfProfile</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;dev&quot;</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;æå››&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;prod&quot;</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;ç‹äº”&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfProfileTest</code>ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAnnotationConfigurationOfProfileTest</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">SpringAnnotationConfigurationOfProfileTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token annotation punctuation">@Test</span>  
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">MainConfigOfProfile</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">&gt;</span></span> beansOfType <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBeansOfType</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è·å–åˆ°çš„teacherå®ä¾‹ï¼š{}&quot;</span><span class="token punctuation">,</span> beansOfType<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120129565.png" loading="lazy" class="lazy"><br>
æƒŠè®¶åœ°å‘ç°æ²¡æœ‰æ‰¾åˆ°ä»»ä½• <code>Person</code> ç»„ä»¶ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿï¼ŸåŸå› æ˜¯æ‰€æœ‰ bean éƒ½åŠ äº† <code>@Profile</code> æ³¨è§£ï¼Œåªæœ‰åœ¨æŒ‡å®šçš„ç¯å¢ƒä¸‹å½“å‰çš„ bean æ‰ä¼šè¢«æ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼Œç„¶è€Œ <strong>é»˜è®¤çš„ç¯å¢ƒä¸º <code>default</code></strong>ï¼Œåœ¨ <code>default</code> ç¯å¢ƒä¸‹å½“ç„¶æ‰¾ä¸åˆ° <code>Person</code> ç»„ä»¶ï¼Œæ‰€ä»¥ç°åœ¨è®©é»˜è®¤ç¯å¢ƒä¸‹å°† <code>Person</code> å¼ ä¸‰æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainConfigOfProfile</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;dev&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;æå››&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">&quot;prod&quot;</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Bean</span>  
    <span class="token keyword">public</span> <span class="token class-name">Person</span> <span class="token function">person3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;ç‹äº”&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>è¿è¡Œæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfProfileTest</code> ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120129657.png" loading="lazy" class="lazy"><br>
å‡å¦‚ï¼Œæƒ³å°† Person æå››å’Œç‹äº”æ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ï¼Œå°±éœ€è¦ä¿®æ”¹ç¯å¢ƒï¼Œæ€ä¹ˆä¿®æ”¹å‘¢ï¼Ÿåœ¨ <code>@Profile</code> æ³¨è§£çš„æ³¨é‡Šæ˜ç¡®æŒ‡å‡ºäº†ä»¥ä¸‹å‡ ç§æ–¹æ³•æ¥åˆ‡æ¢ç¯å¢ƒï¼š</p> <blockquote><p>å¯ä»¥é€šè¿‡ ConfigurableEnvironment.setActiveProfiles ä»¥ç¼–ç¨‹æ–¹å¼æ¿€æ´»ï¼Œæˆ–è€…é€šè¿‡å°† spring.profiles.active å±æ€§è®¾ç½®ä¸º JVM ç³»ç»Ÿå±æ€§ã€ç¯å¢ƒå˜é‡æˆ– web.xml ä¸­çš„ Servlet ä¸Šä¸‹æ–‡å‚æ•°ä»¥å£°æ˜æ–¹å¼æ¿€æ´»åº”ç”¨ç¨‹åº</p></blockquote> <p>ç°åœ¨é€šè¿‡ä½¿ç”¨è™šæ‹Ÿæœºå‚æ•°æ¥å°†ç¯å¢ƒåˆ‡æ¢åˆ° dev å’Œ prod ç¯å¢ƒï¼Œ<code>-Dspring.profiles.active=test,prod</code>ã€‚<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120129136.png" loading="lazy" class="lazy"><br>
è¿è¡Œæµ‹è¯•ç±» <code>SpringAnnotationConfigurationOfProfileTest</code> ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br> <img alt="" data-src="https://fastly.jsdelivr.net/gh/xihuanxiaorang/images/202211120129405.png" loading="lazy" class="lazy"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/xihuanxiaorang/CodeGuide/edit/main/docs/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/Springæ³¨è§£é©±åŠ¨å¼€å‘.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°: </span> <span class="time">2022/11/13</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/äº‹åŠ¡.html" class="prev">
          Springäº‹åŠ¡
        </a></span> <span class="next"><a href="/blog/md/springå…¨å®¶æ¡¶/spring/æºç /Springæºç ç¯å¢ƒæ­å»º.html">
          Springæºç ç¯å¢ƒæ­å»º
        </a>
        â†’
      </span></p></div> </main></div> <aside class="page-sidebar"> <div class="page-side-toolbar"><div class="option-box-toc-fixed"><div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">Springæ³¨è§£é©±åŠ¨å¼€å‘</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_1-æ¥”å­" class="toc-sidebar-link">1. æ¥”å­</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-ç»„ä»¶æ³¨å†Œ" class="toc-sidebar-link">2. ç»„ä»¶æ³¨å†Œ</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-1-configuration-bean-æ³¨è§£" class="toc-sidebar-link">2.1. @Configuration&amp;@Bean æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-2-componentscan-æ³¨è§£" class="toc-sidebar-link">2.2. @ComponentScan æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-3-scope-æ³¨è§£" class="toc-sidebar-link">2.3. @Scope æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-4-lazy-æ³¨è§£" class="toc-sidebar-link">2.4. @Lazy æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-5-conditional-æ³¨è§£" class="toc-sidebar-link">2.5. @Conditional æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-6-import-æ³¨è§£" class="toc-sidebar-link">2.6. @Import æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-7-factorybean" class="toc-sidebar-link">2.7. FactoryBean</a></li></ul></li><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_3-ç”Ÿå‘½å‘¨æœŸ" class="toc-sidebar-link">3. ç”Ÿå‘½å‘¨æœŸ</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_3-1-init-method-destroy-method" class="toc-sidebar-link">3.1. init-method &amp; destroy-method</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_3-2-initializingbean-disposablebean" class="toc-sidebar-link">3.2. InitializingBean &amp; DisposableBean</a></li></ul></li><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_4-å±æ€§èµ‹å€¼" class="toc-sidebar-link">4. å±æ€§èµ‹å€¼</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_5-è‡ªåŠ¨è£…é…" class="toc-sidebar-link">5. è‡ªåŠ¨è£…é…</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_5-1-autowired-æ³¨è§£" class="toc-sidebar-link">5.1. @Autowired æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_5-2-resourece-æ³¨è§£" class="toc-sidebar-link">5.2. @Resourece æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_5-3-profile-æ³¨è§£" class="toc-sidebar-link">5.3. @Profile æ³¨è§£</a></li></ul></li></ul></div></div></div></div></div> <div class="option-box-toc-over"><img src="/images/system/toc.png" class="nozoom"> <span class="show-txt">ç›®å½•</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:550px"><div style="font-weight:bold;text-align:center;">Springæ³¨è§£é©±åŠ¨å¼€å‘</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_1-æ¥”å­" class="toc-sidebar-link">1. æ¥”å­</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-ç»„ä»¶æ³¨å†Œ" class="toc-sidebar-link">2. ç»„ä»¶æ³¨å†Œ</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-1-configuration-bean-æ³¨è§£" class="toc-sidebar-link">2.1. @Configuration&amp;@Bean æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-2-componentscan-æ³¨è§£" class="toc-sidebar-link">2.2. @ComponentScan æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-3-scope-æ³¨è§£" class="toc-sidebar-link">2.3. @Scope æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-4-lazy-æ³¨è§£" class="toc-sidebar-link">2.4. @Lazy æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-5-conditional-æ³¨è§£" class="toc-sidebar-link">2.5. @Conditional æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-6-import-æ³¨è§£" class="toc-sidebar-link">2.6. @Import æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_2-7-factorybean" class="toc-sidebar-link">2.7. FactoryBean</a></li></ul></li><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_3-ç”Ÿå‘½å‘¨æœŸ" class="toc-sidebar-link">3. ç”Ÿå‘½å‘¨æœŸ</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_3-1-init-method-destroy-method" class="toc-sidebar-link">3.1. init-method &amp; destroy-method</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_3-2-initializingbean-disposablebean" class="toc-sidebar-link">3.2. InitializingBean &amp; DisposableBean</a></li></ul></li><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_4-å±æ€§èµ‹å€¼" class="toc-sidebar-link">4. å±æ€§èµ‹å€¼</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_5-è‡ªåŠ¨è£…é…" class="toc-sidebar-link">5. è‡ªåŠ¨è£…é…</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_5-1-autowired-æ³¨è§£" class="toc-sidebar-link">5.1. @Autowired æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_5-2-resourece-æ³¨è§£" class="toc-sidebar-link">5.2. @Resourece æ³¨è§£</a></li><li class="toc-sidebar-sub-header"><a href="/blog/md/spring%E5%85%A8%E5%AE%B6%E6%A1%B6/spring/%E5%9F%BA%E7%A1%80/Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91.html#_5-3-profile-æ³¨è§£" class="toc-sidebar-link">5.3. @Profile æ³¨è§£</a></li></ul></li></ul></div></div></div></div></div> <div class="option-box"><img src="/images/system/toggle.png" width="30px" class="nozoom"> <span class="show-txt">å·¦æ </span></div> <div class="option-box"><img src="/images/system/heart-1.png" width="25px" class="nozoom"> <span class="show-txt">èµèµæˆ‘</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">é¼“åŠ±/æ”¯æŒ/èµèµæˆ‘</span> <img height="180px" src="/images/personal/encourage-head.png" style="margin:5px;"> <br>1. ä¸é å®ƒç”Ÿå­˜ä½†ä»å¸Œæœ›å¾—åˆ°ä½ çš„é¼“åŠ±ï¼›
                <br>2. æ—¶åˆ»è­¦é†’è‡ªå·±ä¿æŒæŠ€æœ¯äººçš„åˆå¿ƒï¼Œæ²‰æ·€ï¼Œåˆ†äº«ï¼Œæˆé•¿ï¼›
              </div></div></div></div> <div title="Springäº‹åŠ¡" class="option-box" style="padding-left:2px;text-align:center;"><a href="/blog/md/springå…¨å®¶æ¡¶/spring/åŸºç¡€/äº‹åŠ¡.html"><img src="/images/system/pre2.png" width="30px" class="nozoom"> <span class="show-txt">ä¸Šä¸€ç¯‡</span></a></div> <div title="Springæºç ç¯å¢ƒæ­å»º" class="option-box" style="padding-left:2px;text-align:center;"><a href="/blog/md/springå…¨å®¶æ¡¶/spring/æºç /Springæºç ç¯å¢ƒæ­å»º.html"><img src="/images/system/next2.png" width="30px" class="nozoom"> <span class="show-txt">ä¸‹ä¸€ç¯‡</span></a></div></div>  <div class="page-side-sitemap"><div class="option-box"><img src="/images/system/sitemap.png" class="nozoom img"> <span class="show-txt">ç«™ç‚¹å›¾</span> <div class="sitemap-container"><h4>ç«™ç‚¹å¯¼èˆªå›¾
              <a href="/blog/md/about/me/2020-08-25-13å¹´æ¯•ä¸šï¼Œç”¨ä¸¤å¹´æ—¶é—´ä»å¤–åŒ…èµ°è¿›äº’è”ç½‘å¤§å‚.html" class="sitemap-top-link"> å…³äºæˆ‘</a> <a href="/blog/md/about/study/2020-04-30-è®²é“ç†ï¼Œåªè¦ä½ æ˜¯ä¸€ä¸ªçˆ±æŠ˜è…¾çš„ç¨‹åºå‘˜ï¼Œæ¯•ä¸šæ‰¾å·¥ä½œçœŸçš„ä¸éœ€è¦å†èŠ±é’±åŸ¹è®­.html" class="sitemap-top-link"> å…³äºå­¦ä¹ </a> <a href="/blog/md/about/job/2020-11-15-BATJTMDï¼Œå¤§å‚æ‹›è˜ï¼Œéƒ½æ‹›ä»€ä¹ˆæ ·Javaç¨‹åºå‘˜ï¼Ÿ.html" class="sitemap-top-link"> å…³äºèŒåœº</a></h4> <table class="sitemap-table"><tr><td nowrap="nowrap"><div class="sitemap-col-group">å¸¸ç”¨æœç´¢</div></td> <td><div class="sitemap-col-item"><a href="http://www.baidu.com/" target="_blank" title="ç™¾åº¦">  
          ç™¾åº¦
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.google.com/" target="_blank" title="Google">  
          Google
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.bing.com/" target="_blank" title="Bing">  
          Bing
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://github.com" target="_blank" title="Github">  
          Github
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.programcreek.com/java-api-examples/index.php" target="_blank" title="æœä»£ç ">  
          æœä»£ç 
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></td> <!----></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">æŠ€æœ¯ç¤¾åŒº</div></td> <td><div class="sitemap-col-item"><a href="http://www.csdn.net/" target="_blank" title="CDSN">  
          CDSN
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.cnblogs.com/" target="_blank" title="åšå®¢å›­">  
          åšå®¢å›­
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.oschina.net" target="_blank" title="OSChina">  
          OSChina
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://segmentfault.com/" target="_blank" title="æ€å¦">  
          æ€å¦
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://juejin.im" target="_blank" title="æ˜é‡‘">  
          æ˜é‡‘
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.linuxidc.com/" target="_blank" title="Linuxå…¬ç¤¾">  
          Linuxå…¬ç¤¾
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.ibm.com/developerworks/cn/" target="_blank" title="IBM å¼€å‘è€…">  
          IBM å¼€å‘è€…
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://stackoverflow.com" target="_blank" title="StackOverflow">  
          StackOverflow
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></td> <!----></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">Spring</div></td> <!----> <td><a href="/blog/md/spring/source-code/index.html" class="sitemap-col-item">
          Spring æºç åˆ†æ
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">é¢å‘å¯¹è±¡</div></td> <!----> <td><a href="/blog/md/develop/design-pattern/index.html" class="sitemap-col-item">
          è®¾è®¡æ¨¡å¼
        </a></td></tr></table></div></div></div> <!----> </aside></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/cg-styles.js?v=1668302853734" defer></script><script src="/blog/assets/js/cg-3.js?v=1668302853734" defer></script><script src="/blog/assets/js/cg-4.js?v=1668302853734" defer></script><script src="/blog/assets/js/cg-21.js?v=1668302853734" defer></script><script src="/blog/assets/js/cg-app.js?v=1668302853734" defer></script>
  </body>
</html>
